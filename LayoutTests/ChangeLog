2022-03-22  Matteo Flores  <matteo_flores@apple.com>

        REGRESSION(r289402-r289376): [ Debug iOS ] webgl/1.0.3/conformance/uniforms/uniform-samplers-test.html is a constant timeout
        https://bugs.webkit.org/show_bug.cgi?id=237694

        Unreviewed test gardening.

        * platform/ios/TestExpectations:

2022-03-22  Robert Jenner  <Jenner@apple.com>

        imported/w3c/web-platform-tests/webaudio/the-audio-api/the-mediaelementaudiosourcenode-interface/mediaElementAudioSourceToScriptProcessorTest.html fails (221819)
        https://bugs.webkit.org/show_bug.cgi?id=221819

        Unreviewed test gardening. Re-baseline for wk1.

        * platform/mac-wk1/imported/w3c/web-platform-tests/webaudio/the-audio-api/the-mediaelementaudiosourcenode-interface/mediaElementAudioSourceToScriptProcessorTest-expected.txt: Added.

2022-03-22  Robert Jenner  <Jenner@apple.com>

        [ macOS Debug ] inspector/console/queryInstances.html is a flaky failure (215814)
        https://bugs.webkit.org/show_bug.cgi?id=215814

        Unreviewed test gardening.

        * platform/mac/TestExpectations: Removing no longer needed test expectation.

2022-03-22  Robert Jenner  <Jenner@apple.com>

        inspector/canvas/setRecordingAutoCaptureFrameCount.html is flaky failing (228011)
        https://bugs.webkit.org/show_bug.cgi?id=228011

        Unreviewed test gardening.

        * platform/mac/TestExpectations: Removing no longer needed test expectation.

2022-03-22  Matteo Flores  <matteo_flores@apple.com>

        [ iOS GPUP arm64 ] 5 webaudio/* are constant text failures since being unskipped.
        https://bugs.webkit.org/show_bug.cgi?id=238220

        Unreviewed test gardening.

        * platform/ios-simulator/TestExpectations:

2022-03-22  Chris Dumez  <cdumez@apple.com>

        REGRESSION (iOS 15.1 / r280824) QuickLook - model not loading when passing extra parameters
        https://bugs.webkit.org/show_bug.cgi?id=236069
        <rdar://problem/88461772>

        Reviewed by Darin Adler.

        Add layout test coverage.

        * fast/files/blob-with-fragment-as-frame-url-expected.txt: Added.
        * fast/files/blob-with-fragment-as-frame-url.html: Added.

2022-03-22  Matteo Flores  <matteo_flores@apple.com>

        [ iOS EWS ] fast/text/text-shadow-ink-overflow-missing.html is a flaky image failure
        https://bugs.webkit.org/show_bug.cgi?id=238211

        Unreviewed test gardening.

        * platform/ios/TestExpectations:

2022-03-22  Jer Noble  <jer.noble@apple.com>

        YouTube.com - Clicking anywhere on the progress bar pauses the video
        https://bugs.webkit.org/show_bug.cgi?id=237750
        <rdar://problem/90364846>

        Reviewed by Eric Carlson.

        * media/media-source/media-source-unexpected-pause-expected.txt: Added.
        * media/media-source/media-source-unexpected-pause.html: Added.

2022-03-22  Ricky Mondello  <rmondello@apple.com>

        It should be possible to copy text out of "AutoFilledAndViewable" password fields
        https://bugs.webkit.org/show_bug.cgi?id=238160

        Reviewed by Geoffrey Garen.

        * fast/forms/input-autofilled-and-viewable.html: Test copying.

2022-03-22  Jer Noble  <jer.noble@apple.com>

        Fetching a Blob URL with an unbounded Range header do not generate a Content-Range response header
        https://bugs.webkit.org/show_bug.cgi?id=238170

        Reviewed by Eric Carlson.

        * fetch/fetch-blob-unbounded-range-expected.txt: Added.
        * fetch/fetch-blob-unbounded-range.html: Added.

2022-03-22  Carlos Garcia Campos  <cgarcia@igalia.com>

        [GTK][WPE] Remove the ATK implementation
        https://bugs.webkit.org/show_bug.cgi?id=238198

        Reviewed by Adrian Perez de Castro.

        * accessibility/gtk/aria-modal-state-exposed-expected.txt:
        * accessibility/gtk/aria-modal-state-exposed.html:
        * accessibility/gtk/name-from-label-expected.txt:
        * accessibility/gtk/name-from-label.html:
        * accessibility/gtk/object-attributes-expected.txt:
        * accessibility/gtk/object-attributes.html:
        * accessibility/language-attribute.html:

2022-03-22  Ziran Sun  <zsun@igalia.com>

        [selection] Change form's selection attribute to unsigned long
        https://bugs.webkit.org/show_bug.cgi?id=237951

        Reviewed by Chris Dumez.

        Update test accordingly. This is inline with Chromium.

        Note that for selection-start-end-readonly.html, two sub-tests
        are now failing. This is the right behaviour since the test assumes
        types for selectionStart and selectionEnd as "int". We could modify the
        test and make the type as unsigned. Interestingly the test script's
        format is strange and it seems having "return" for each line. Simply updating
        some lines on the test scripts causes errors when applying the patch. We have
        decided to address this test in a separate patch (maybe remove the file and added
        a new one with proper format).
        
        * fast/forms/input-appearance-selection.html:
        * fast/forms/selection-functions-expected.txt:
        * fast/forms/selection-start-end-readonly-expected.txt:

2022-03-21  Said Abou-Hallawa  <said@apple.com>

        [GPU Process] Make GraphicsContextState keep track of changes till they are applied
        https://bugs.webkit.org/show_bug.cgi?id=238066
        rdar://90585183

        Reviewed by Simon Fraser.

        * displaylists/extent-includes-shadow-expected.txt:
        * displaylists/extent-includes-transforms-expected.txt:
        * displaylists/layer-dispay-list-expected.txt:
        * gpu-process/TestExpectations:

2022-03-21  Tyler Wilcock  <tyler_w@apple.com>

        AX: AccessibilityObject::visibleCharacterRange is extremely slow when called on objects with lots of text
        https://bugs.webkit.org/show_bug.cgi?id=237678

        Reviewed by Andres Gonzalez.

        Add many new visible character range testcases split across four new tests.

        * accessibility/visible-character-range-basic.html: Added.
        * accessibility/visible-character-range-height-changes.html: Added.
        * accessibility/visible-character-range-scrolling.html: Added.
        * accessibility/visible-character-range-width-changes.html: Added.
        * platform/glib/TestExpectations: Skip new tests.
        * platform/ios-simulator-wk2/TestExpectations:
        Mark new tests as crashing since the old test was crashing in `main`.
        * platform/ios/TestExpectations: Enable new tests.
        * platform/ios/accessibility/visible-character-range-basic-expected.txt: Added.
        * platform/ios/accessibility/visible-character-range-expected.txt: Removed.
        * platform/ios/accessibility/visible-character-range-height-changes-expected.txt: Added.
        * platform/ios/accessibility/visible-character-range-scrolling-expected.txt: Added.
        * platform/ios/accessibility/visible-character-range-width-changes-expected.txt: Added.
        * platform/mac-wk1/TestExpectations: Skip new tests.
        * platform/mac/accessibility/visible-character-range-basic-expected.txt: Added.
        * platform/mac/accessibility/visible-character-range-expected.txt: Removed.
        * platform/mac/accessibility/visible-character-range-height-changes-expected.txt: Added.
        * platform/mac/accessibility/visible-character-range-scrolling-expected.txt: Added.
        * platform/mac/accessibility/visible-character-range-width-changes-expected.txt: Added.
        * platform/win/TestExpectations: Skip new tests.
        * resources/accessibility-helper.js:
        (visibleRange): Added.

2022-03-21  Matteo Flores  <matteo_flores@apple.com>

        [ iOS iPhone 12 ] fast/hidpi & fast/layers/hidpi tests are flaky text/image failing
        https://bugs.webkit.org/show_bug.cgi?id=232384

        Unreviewed test gardening.

        * platform/ios/TestExpectations:

2022-03-21  Robert Jenner  <Jenner@apple.com>

        REGRESSION: [ Monterey ] imported/w3c/web-platform-tests/html/canvas/element/line-styles/2d.line.width.scaledefault.html is a constant text failure
        <rdar://problem/77527575?

        Unreviewed test gardening.

        * platform/mac/TestExpectations: Removing no longer needed test expectation. 

2022-03-21  Kate Cheney  <katherine_cheney@apple.com>

        nj.gov: Background color incorrect for 'State Vehicles' section
        https://bugs.webkit.org/show_bug.cgi?id=238035
        <rdar://problem/84543795>

        Reviewed by Aditya Keerthi.

        * fast/css/non-form-control-element-drop-appearance-expected.html: Added.
        * fast/css/non-form-control-element-drop-appearance.html: Added.
        * editing/deleting/insert-in-orphaned-selection-crash.html: Added.
        Now that we drop native style for non-form control elements, we need to
        add height to the style to make sure this table element is selectable and
        successfully tests what it needs to test.

2022-03-21  Commit Queue  <commit-queue@webkit.org>

        Unreviewed, reverting r291055.
        https://bugs.webkit.org/show_bug.cgi?id=238145

        Invalid test expectations

        Reverted changeset:

        "[iOS] Hard link AVPictureInPictureController"
        https://bugs.webkit.org/show_bug.cgi?id=237227
        https://commits.webkit.org/r291055

2022-03-21  Matteo Flores  <matteo_flores@apple.com>

        REGRESSION(r290797-r290793): [ iOS Debug ] 4 editing/selection/* tests are constant timeouts
        https://bugs.webkit.org/show_bug.cgi?id=238155

        Unreviewed test gardening.

        * platform/ios/TestExpectations:
        
2022-03-21  Myles C. Maxfield  <mmaxfield@apple.com>

        [WebGPU] Set the WebGPU WKPreference to true in layout tests
        https://bugs.webkit.org/show_bug.cgi?id=238130

        Reviewed by Sam Weinig.

        * platform/mac-wk1/fast/dom/navigator-detached-no-crash-expected.txt:
        * platform/mac-wk2/fast/dom/navigator-detached-no-crash-expected.txt:

2022-03-21  Tyler Wilcock  <tyler_w@apple.com>

        AX: Include display: contents elements in the AX tree
        https://bugs.webkit.org/show_bug.cgi?id=237834

        Reviewed by Chris Fleizach.

        * accessibility/aria-hidden-display-contents-element-expected.txt: Added.
        * accessibility/aria-hidden-display-contents-element.html: Added.
        * accessibility/display-contents-element-roles-expected.txt: Added.
        * accessibility/display-contents-element-roles.html: Added.
        * platform/glib/accessibility/aria-hidden-display-contents-element-expected.txt: Added.
        * platform/glib/accessibility/display-contents-element-roles-expected.txt: Added.
        * platform/ios/TestExpectations: Enable new tests.
        * platform/ios/accessibility/aria-hidden-display-contents-element-expected.txt: Added.
        * platform/ios/accessibility/display-contents-element-roles-expected.txt: Added.
        * platform/win/TestExpectations: Skip display-contents-element-roles.html.
        * platform/win/accessibility/aria-hidden-display-contents-element-expected.txt: Added.

2022-03-21  Ziran Sun  <zsun@igalia.com>

        [selection] HTMLTextFormControlElement::subtreeHasChanged() shouldn't be called in setRangeText
        https://bugs.webkit.org/show_bug.cgi?id=237720

        Reviewed by Chris Dumez.

        Update test expectation as the test is now passing.
        * fast/forms/setrangetext-expected.txt:

2022-03-21  Carlos Garcia Campos  <cgarcia@igalia.com>

        REGRESSION(r286955): Rendering Links during search: highlighting fails
        https://bugs.webkit.org/show_bug.cgi?id=237816

        Reviewed by Simon Fraser.

        * fast/text/selection-with-text-decorations-expected.html: Added.
        * fast/text/selection-with-text-decorations.html: Added.
        * platform/ios/TestExpectations:

2022-03-19  Tyler Wilcock  <tyler_w@apple.com>

        Rebaseline accessibility/roles-exposed.html for Mac WK1 after https://commits.webkit.org/r291401
        https://bugs.webkit.org/show_bug.cgi?id=238099

        Reviewed by Chris Fleizach.

        * platform/mac-wk1/accessibility/roles-exposed-expected.txt:

2022-03-19  Oriol Brufau  <obrufau@igalia.com>

        [cssom] Implement border-image serialization
        https://bugs.webkit.org/show_bug.cgi?id=238102

        Reviewed by Darin Adler.

        Expect cssText to serialize border-image instead of longhands.

        * fast/css/parse-border-image-repeat-null-crash-expected.txt:

2022-03-19  Oriol Brufau  <obrufau@igalia.com>

        Fix hasExplicitlySetBorderRadius flag
        https://bugs.webkit.org/show_bug.cgi?id=238062

        Reviewed by Darin Adler.

        Add test, skip it except in iOS and Mac.

        * TestExpectations:
        * fast/css/appearance-apple-pay-button-border-radius-longhands-expected.html: Added.
        * fast/css/appearance-apple-pay-button-border-radius-longhands.html: Added.
        * platform/ios/TestExpectations:
        * platform/mac/TestExpectations:

2022-03-19  Myles C. Maxfield  <mmaxfield@apple.com>

        Make fast/text/emoji-num-glyphs.html more robust
        https://bugs.webkit.org/show_bug.cgi?id=238120
        <rdar://problem/88842010>

        Unreviewed test gardening.

        * fast/text/emoji-num-glyphs-expected.txt:
        * fast/text/emoji-num-glyphs.html:

2022-03-19  Antoine Quint  <graouts@webkit.org>

        REGRESSION (r285529): Flash of missing text when content on https://ahumanfuture.co animates
        https://bugs.webkit.org/show_bug.cgi?id=237972
        rdar://90385586

        Reviewed by Simon Fraser.

        Add a new test which would fail prior to the source change. In this test we start two animations: a "scale"
        animation which lasts for 100ms, and an "opacity" animation which lasts much longer but only visually updates
        for the duration of the "scale" animation. When the "scale" animation completes, we stop the test and ensure
        that the reference test shows that the "opacity" animation is at the state it should be in at at that time,
        and was not rewound due to the bug being fixed.

        * webanimations/accelerated-animation-opacity-animation-begin-time-after-scale-animation-ends-expected.html: Added.
        * webanimations/accelerated-animation-opacity-animation-begin-time-after-scale-animation-ends.html: Added.

2022-03-18  Devin Rousso  <drousso@apple.com>

        Web Inspector: REGRESSION(?): Emulate User Gesture doesn't work
        https://bugs.webkit.org/show_bug.cgi?id=232584
        <rdar://problem/84899576>

        Reviewed by Patrick Angle.

        * inspector/debugger/breakpoint-action-emulateUserGesture-hasTransientActiviation.html: Added.
        * inspector/debugger/breakpoint-action-emulateUserGesture-hasTransientActiviation-expected.txt: Added.
        * inspector/debugger/evaluateOnCallFrame-emulateUserGesture-hasTransientActivation.html: Added.
        * inspector/debugger/evaluateOnCallFrame-emulateUserGesture-hasTransientActivation-expected.txt: Added.
        * inspector/runtime/callFunctionOn-emulateUserGesture-hasTransientActivation.html: Added.
        * inspector/runtime/callFunctionOn-emulateUserGesture-hasTransientActivation-expected.txt: Added.
        * inspector/runtime/evaluate-emulateUserGesture-hasTransientActivation.html: Added.
        * inspector/runtime/evaluate-emulateUserGesture-hasTransientActivation-expected.txt: Added.

2022-03-21  Ryan Haddad  <ryanhaddad@apple.com>

        Unreviewed test gardening.

        * fast/viewport/watchos/viewport-adaptations-after-navigation-expected.txt:
        * fast/viewport/watchos/viewport-with-system-minimum-layout-margins.html:

2022-03-18  Ryan Haddad  <ryanhaddad@apple.com>

        [macOS arm64] webrtc/vp9-profile2.html is consistently timing out
        https://bugs.webkit.org/show_bug.cgi?id=238104

        Unreviewed test gardening.

        * platform/mac/TestExpectations:

2022-03-18  Nikolaos Mouchtaris  <nmouchtaris@apple.com>

        Allow history swipe in scroller with overscroll-behavior
        https://bugs.webkit.org/show_bug.cgi?id=235851

        Reviewed by Simon Fraser.

        * scrollingcoordinator/mac/latching/horizontal-overflow-back-swipe-overscroll-behavior-expected.txt: Added.
        * scrollingcoordinator/mac/latching/horizontal-overflow-back-swipe-overscroll-behavior.html: Added.

2022-03-18  Simon Fraser  <simon.fraser@apple.com>

        REGRESSION (r290628): Scrubber makes a visual trail when scrubbing on tv.youtube.com
        https://bugs.webkit.org/show_bug.cgi?id=238047
        <rdar://problem/90451319>

        Reviewed by Alan Bujtas.

        * compositing/repaint/move-backing-sharing-layer-expected.txt: Added.
        * compositing/repaint/move-backing-sharing-layer.html: Added.

2022-03-18  Philippe Normand  <pnormand@igalia.com>

        [GStreamer] Initial import of the GstWebRTC backend
        https://bugs.webkit.org/show_bug.cgi?id=236540

        Reviewed by Carlos Garcia Campos and Xabier Rodriguez-Calvar.

        * platform/glib/TestExpectations: Flag most WebRTC as failing. During this first development
        cycle I focused mostly on fixing crashes and only fixed a few failures. The remaining ones
        will be adressed in follow-up patches.
        * platform/glib/fast/mediastream/RTCPeerConnection-localDescription-expected.txt: Added.
        * platform/glib/fast/mediastream/RTCPeerConnection-remoteDescription-expected.txt: Added.
        * platform/glib/fast/mediastream/RTCPeerConnection-setRemoteDescription-offer-expected.txt: Added.
        * platform/glib/fast/mediastream/RTCPeerConnection-stable-expected.txt: Added.

2022-03-18  Kimmo Kinnunen  <kkinnunen@apple.com>

        Recycling a webgl context when it has been lost and restored causes a crash
        https://bugs.webkit.org/show_bug.cgi?id=238024

        Reviewed by Geoffrey Garen.

        Creating excessive amount of contexts will lose the oldest context via
        "simulated context lost" logic, making the contexts non-restorable.

        Previously the test tried to test that requesting a restore on a context that
        had simulated context lost would not restore. However, the test was invalid,
        as it asserted that the context is still lost immediately after preventDefault():

          event.preventDefault();
          if (!contexts[0].isContextLost())
             document.getElementById("result").textContent = "FAIL";

        This is not correct, as the preventDefault() only informs the browser
        that the context should be restored. The restore happens asynchronously.

        Fix the test logic and add extra cases. Make the logic as such:
        1. Lose the context in some way
        2. Wait for context lost event, request restore
        3. Optionally do something that would trigger another way of losing the context
        4. Run assertions about context being still expectedly lost

        The failures in the test expectation:
        FAIL getError expected: INVALID_OPERATION. Was NO_ERROR :
        FAIL getError expected: CONTEXT_LOST_WEBGL. Was NO_ERROR :
        bug 236965

        FAIL Expected restore be ignored, but it was not.
        bug 238034

        * webgl/max-active-contexts-webglcontextlost-prevent-default.html:

2022-03-18  Carlos Garcia Campos  <cgarcia@igalia.com>

        [ATSPI] accessibility/dropdown-value.html is timing out since added in 248145@main
        https://bugs.webkit.org/show_bug.cgi?id=237803
        <rdar://problem/90193311>

        Reviewed by Andres Gonzalez.

        * platform/gtk/TestExpectations: Unskip the test.

2022-03-18  Antoine Quint  <graouts@webkit.org>

        REGRESSION(r291129-r291128): [WK1 EWS] 3 imported/w3c/web-platform-tests/web-animations/animation-model/animation-types/* tests are a constant text failure
        https://bugs.webkit.org/show_bug.cgi?id=238054
        <rdar://problem/90458721>

        Unreviewed test gardening.

        The scroll-behavior property is not enabled on WK1 so we must have specific test expectations for these tests.

        * platform/mac-wk1/TestExpectations:
        * platform/mac-wk1/imported/w3c/web-platform-tests/web-animations/animation-model/animation-types/accumulation-per-property-002-expected.txt: Added.
        * platform/mac-wk1/imported/w3c/web-platform-tests/web-animations/animation-model/animation-types/addition-per-property-002-expected.txt: Added.
        * platform/mac-wk1/imported/w3c/web-platform-tests/web-animations/animation-model/animation-types/interpolation-per-property-002-expected.txt: Added.

2022-03-17  Matteo Flores  <matteo_flores@apple.com>

        REGRESSION(r291129-r291128): [WK1 EWS] 3 imported/w3c/web-platform-tests/web-animations/animation-model/animation-types/* tests are a constant text failure
        https://bugs.webkit.org/show_bug.cgi?id=238054

        Unreviewed test gardening.

        * platform/mac-wk1/TestExpectations:

2022-03-17  Myles C. Maxfield  <mmaxfield@apple.com>

        Make Emoji gender tests more robust
        https://bugs.webkit.org/show_bug.cgi?id=238057
        <rdar://problem/88842010>

        Unreviewed.

        U+26F9 PERSON WITH BALL might have a non-emoji glyph, so we can't expect it to
        always render in its emoji form without a variation selector.

        * fast/text/emoji-gender-2-3-expected.html:
        * fast/text/emoji-gender-2-3.html:
        * fast/text/emoji-gender-fe0f-3-expected.html:
        * fast/text/emoji-gender-fe0f-3.html:

2022-03-17  Myles C. Maxfield  <mmaxfield@apple.com>

        Make fast/text/emoji-num-glyphs.html more robust
        https://bugs.webkit.org/show_bug.cgi?id=238055
        <rdar://problem/88842010>

        Unreviewed.

        U+26F9 PERSON WITH BALL might have a non-emoji glyph. If it has one, and the OS prefers it over the
        emoji glyph, then this test will fail. The solution is to use the emoji-style variation selector
        to specifically request the emoji form.

        * fast/text/emoji-num-glyphs.html:

2022-03-17  Alex Christensen  <achristensen@webkit.org>

        PerformanceNavigationTiming Response Start unavailable when using Service Worker Cache
        https://bugs.webkit.org/show_bug.cgi?id=237317

        Reviewed by Youenn Fablet.

        Test that these values are reasonable after loading the main resource from a service worker's cache.

        * http/wpt/service-workers/navigation-timing.https-expected.txt: Added.
        * http/wpt/service-workers/navigation-timing.https.html: Added.
        * http/wpt/service-workers/navigation-timing.js: Added.
        (event.event.waitUntil.caches.open.string_appeared_here.then):
        (event.event.respondWith.caches.open.string_appeared_here.then):
        * http/wpt/service-workers/resources/navigation-timing-part-2.html: Added.

2022-03-17  Cameron McCormack  <heycam@apple.com>

        Avoid calling connectionClosedFromServer on a connection twice when a version change is active
        https://bugs.webkit.org/show_bug.cgi?id=215271

        Reviewed by Sihui Liu.

        * platform/ios-wk2/TestExpectations:
        * platform/mac/TestExpectations:
        * platform/win/TestExpectations:
        * platform/wincairo/TestExpectations:
        Remove test flakiness annotations.

2022-03-17  Simon Lewis  <simon.lewis@apple.com>

        Functional tests for read and write methods of JSIPCStreamConnectionBuffer
        https://bugs.webkit.org/show_bug.cgi?id=237730
        rdar://problem/89676460

        Reviewed by Kimmo Kinnunen.

        * ipc/stream-buffer-read-write-expected.txt: Added.
        * ipc/stream-buffer-read-write.html: Added.

2022-03-17  Ellie Epskamp-Hunt  <eepskamphunt@apple.com>

        When a “autofilled and obscured” field becomes empty, turn “autofilled and obscured” off
        https://bugs.webkit.org/show_bug.cgi?id=235256

        Reviewed by Devin Rousso.

        Add tests to verify that when a text field becomes empty, the autofilled-and-obscured
        property is removed from that field.

        * fast/forms/input-autofilled-and-obscured-clear-field-programatically-expected.txt: Added.
        * fast/forms/input-autofilled-and-obscured-clear-field-programatically.html: Added.
        Delete the text by setting the input's value to an empty string.
        * fast/forms/input-autofilled-and-obscured-clear-form-programatically-expected.txt: Added.
        * fast/forms/input-autofilled-and-obscured-clear-form-programatically.html: Added.
        Delete the text by calling reset on the form.
        * fast/forms/input-autofilled-and-obscured-expected.txt: Added.
        * fast/forms/input-autofilled-and-obscured.html: Added.
        Delete the text as a user would.

2022-03-17  Ben Nham  <nham@apple.com>

        Only show notification permission prompt on user gesture
        https://bugs.webkit.org/show_bug.cgi?id=237946

        Reviewed by Geoffrey Garen.

        Add test cases to make sure that prompting for notification permissions fails when not
        handling a user gesture and succeeds when handling a user gesture.

        * http/tests/notifications/notification-request-permission-no-callback.html:
        * http/tests/notifications/notification-request-permission.html:
        * http/tests/notifications/request-expected.txt:
        * http/tests/notifications/request-with-promise-expected.txt:
        * http/tests/notifications/request-with-promise.html:
        * http/tests/notifications/request.html:
        * http/tests/push-api/resources/subscribe-iframe-cross-origin.html:
        * http/tests/push-api/resources/subscribe-iframe-same-origin.html:
        * http/tests/push-api/resources/subscribe-tests.js:
        (async testDocumentSubscribeWithUserGesture): Added.
        (async testDocumentSubscribeWithoutUserGesture): Added.
        (async testDocumentSubscribeImpl): Added.
        (async testDocumentSubscribe): Deleted.
        * http/tests/push-api/subscribe-default-permissions-expected.txt:
        * http/tests/push-api/subscribe-default-permissions-iframe-cross-origin-expected.txt:
        * http/tests/push-api/subscribe-default-permissions-iframe-same-origin-expected.txt:
        * http/tests/push-api/subscribe-default-permissions.html:
        * http/tests/push-api/subscribe-deny-permissions-expected.txt:
        * http/tests/push-api/subscribe-deny-permissions.html:
        * http/tests/push-api/subscribe-grant-permissions-expected.txt:
        * http/tests/push-api/subscribe-grant-permissions.html:

2022-03-17  Andres Gonzalez  <andresg_22@apple.com>

        Fix for accessibility/aria-tab-xxx.html tests in isolated tree mode.
        https://bugs.webkit.org/show_bug.cgi?id=237980
        <rdar://problem/90392451>

        Reviewed by Chris Fleizach.

        these tests are flaky in isolated tree mode due to setting the focus to
        the body is async.

        * accessibility/aria-tab-role-on-buttons-expected.txt:
        * accessibility/aria-tab-role-on-buttons.html:
        * accessibility/aria-tab-roles.html:
        * platform/glib/accessibility/aria-tab-roles-expected.txt:
        * platform/mac/accessibility/aria-tab-role-on-buttons-expected.txt:
        * platform/mac/accessibility/aria-tab-roles-expected.txt:
        * platform/win/accessibility/aria-tab-role-on-buttons-expected.txt:
        * platform/win/accessibility/aria-tab-roles-expected.txt:

2022-03-17  Andres Gonzalez  <andresg_22@apple.com>

        Make accessibility/roles-exposed.html faster.
        https://bugs.webkit.org/show_bug.cgi?id=237960
        <rdar://problem/90371580>

        Reviewed by Chris Fleizach.

        Make this test to run faster by storing the output in memory and
        modifying the DOM once as opposed to doing it in each iteration. This is
        particularly important in isolated tree mode, since the test is failing
        because it takes too long to execute.
        Also modify the test and expectations to explicitly output when the AX
        object cannot be retrieved, i.e., it is not exposed for some reason.

        * accessibility/roles-exposed.html:
        * platform/mac-wk2/accessibility/roles-exposed-expected.txt:

2022-03-17  Andres Gonzalez  <andresg_22@apple.com>

        Fix for accessibility/aria-option-role.html in isolated tree mode.
        https://bugs.webkit.org/show_bug.cgi?id=237975
        <rdar://problem/90386629>

        Reviewed by Chris Fleizach.

        This test was flaky in isolated tree mode due to setting the focus to
        the body is async. Solved by retrieving the AX element of the listbox
        directly.

        * accessibility/aria-option-role.html:
        * platform/glib/accessibility/aria-option-role-expected.txt:
        * platform/mac/accessibility/aria-option-role-expected.txt:
        * platform/win/accessibility/aria-option-role-expected.txt:

2022-03-17  Kimmo Kinnunen  <kkinnunen@apple.com>

        WebGL context lost event is not sent again for contexts that are lost and restored
        https://bugs.webkit.org/show_bug.cgi?id=237952

        Reviewed by Antti Koivisto.

        * platform/glib/TestExpectations:
        * webgl/lose-context-after-context-lost-expected.txt:
        * webgl/lose-context-after-context-lost.html:
        Enable the test for GPUP, it works now after
        r290816 "WebGL context count is not limited for GPU process.".
        Adjust the order of waiting for webglcontextlost and checking
        isContextLost(), so that it works when context loss is reported
        asynchronously by GPUP.

        * webgl/multiple-context-losses-expected.txt: Added.
        * webgl/multiple-context-losses.html: Added.
        Add a test testing the bug fix.

2022-03-17  Ziran Sun  <zsun@igalia.com>

        [Selection] Fixes selection range settings for TEXTAREA
        https://bugs.webkit.org/show_bug.cgi?id=237641

        Reviewed by Chris Dumez.

        Updated two tests that expect resetting value of textarea to change selection to 0.
        These changes are in line with changes made in Chromium.
        * editing/pasteboard/paste-into-textarea-with-new-line.html:
        * fast/spatial-navigation/snav-textarea.html:

2022-03-17  Youenn Fablet  <youenn@apple.com>

        AudioContext is suspended on iOS when page is backgrounded
        https://bugs.webkit.org/show_bug.cgi?id=237878

        Reviewed by Eric Carlson.

        * webaudio/suspend-context-while-backgrounded-expected.txt: Added.
        * webaudio/suspend-context-while-backgrounded.html: Added.

2022-03-16  Matteo Flores  <matteo_flores@apple.com>

        [ iOS EWS ] imported/w3c/web-platform-tests/html/semantics/forms/textfieldselection/selection-not-application-textarea.html is a flaky text failure
        https://bugs.webkit.org/show_bug.cgi?id=237987

        Unreviewed test gardening.

        * platform/ios/TestExpectations:

2022-03-16  Fujii Hironori  <Hironori.Fujii@sony.com>

        [WinCairo] Unreviewed test gardening

        * platform/wincairo/TestExpectations:
        * platform/wincairo/css1/box_properties/margin_right-expected.txt:
        * platform/wincairo/css1/box_properties/padding_right-expected.txt:
        * platform/wincairo/css2.1/t0505-c16-descendant-01-e-expected.txt:
        * platform/wincairo/fast/dom/HTMLMeterElement/meter-boundary-values-expected.txt:
        * platform/wincairo/fast/dom/HTMLMeterElement/meter-optimums-expected.txt:
        * platform/wincairo/fast/dom/HTMLProgressElement/progress-bar-value-pseudo-element-expected.txt:
        * platform/wincairo/fast/dom/scroll-reveal-top-overflow-expected.txt:
        * platform/wincairo/fast/html/details-writing-mode-expected.txt:
        * platform/wincairo/fast/text/international/synthesized-italic-vertical-latin-expected.txt:

2022-03-16  Rob Buis  <rbuis@igalia.com>

        Sync css/css-contain from WPT
        https://bugs.webkit.org/show_bug.cgi?id=237705

        Reviewed by Manuel Rego Casasnovas.

        Mark as failing for now.

        * platform/ios/TestExpectations:

2022-03-16  Kate Cheney  <katherine_cheney@apple.com>

        [ MacOS ] http/tests/security/content SecurityPolicy/frame-src-cross-origin-load.html is a flakey failure (230428)
        https://bugs.webkit.org/show_bug.cgi?id=230428
        <rdar://problem/83254559>

        Reviewed by Brent Fulgham.

        The flakiness was caused by relying on ordered output from iframe
        loads that are not guaranteed to load in order. This change loads
        iframes in script to make sure they load only after the previous
        iframe has loaded.

        * http/tests/security/contentSecurityPolicy/frame-src-cross-origin-load-expected.txt:
        * http/tests/security/contentSecurityPolicy/frame-src-cross-origin-load.html:
        * platform/mac/TestExpectations:

2022-03-16  Philippe Normand  <pnormand@igalia.com>

        [GStreamer][1.20] media/video-src-blob-perf.html failing
        https://bugs.webkit.org/show_bug.cgi?id=237256
        <rdar://problem/89530009>

        Unreviewed, unflag test passing after Flatpak SDK update.

        * platform/glib/TestExpectations:

2022-03-16  Wenson Hsieh  <wenson_hsieh@apple.com>

        [iOS] Refactor some position information hit-testing logic related to data detectors in Live Text
        https://bugs.webkit.org/show_bug.cgi?id=237927

        Reviewed by Tim Horton.

        Add a simple layout test that exercises context menu presentation when long pressing a data detector result
        inside Live Text in an image. While this behavior isn't new, it's currently untested before this patch.

        * fast/images/text-recognition/ios/show-data-detector-context-menu-expected.txt: Added.
        * fast/images/text-recognition/ios/show-data-detector-context-menu.html:

        Also add `-webkit-user-select: none;` to test that disabling text selection does not also disable the ability to
        present the context menu over data detectors by long pressing on iOS.

2022-03-16  Youenn Fablet  <youenn@apple.com>

        redirectCount returns 0 when using a Service Worker
        https://bugs.webkit.org/show_bug.cgi?id=235710
        <rdar://problem/88432190>

        Reviewed by Chris Dumez.

        * http/wpt/service-workers/navigation-redirect-main-frame.https.html:

2022-03-16  Youenn Fablet  <youenn@apple.com>

        LayoutTests/webaudio tests are skipped in iOS
        https://bugs.webkit.org/show_bug.cgi?id=237889

        Unreviewed.

        Unskip tests and removed obsolete iOS specific expected.txt files.

        * platform/ios/TestExpectations:
        * platform/ios/webaudio/analyser-exception-expected.txt: Removed.
        * platform/ios/webaudio/audiobuffer-expected.txt: Removed.
        * platform/ios/webaudio/audiobuffer-neuter-expected.txt: Removed.
        * platform/ios/webaudio/audiobuffersource-channels-expected.txt: Removed.
        * platform/ios/webaudio/audiobuffersource-ended-expected.txt: Removed.
        * platform/ios/webaudio/audiobuffersource-exception-expected.txt: Removed.
        * platform/ios/webaudio/audiobuffersource-loop-comprehensive-expected.txt: Removed.
        * platform/ios/webaudio/audiobuffersource-loop-points-expected.wav: Removed.
        * platform/ios/webaudio/audiobuffersource-playbackState-expected.txt: Removed.
        * platform/ios/webaudio/audiobuffersource-playbackrate-expected.wav: Removed.
        * platform/ios/webaudio/audiobuffersource-start-expected.txt: Removed.
        * platform/ios/webaudio/audiochannelmerger-basic-expected.txt: Removed.
        * platform/ios/webaudio/audiochannelsplitter-expected.txt: Removed.
        * platform/ios/webaudio/audionode-expected.txt: Removed.
        * platform/ios/webaudio/biquadfilternode-basic-expected.txt: Removed.
        * platform/ios/webaudio/codec-tests/aac/vbr-128kbps-44khz-expected.wav: Removed.
        * platform/ios/webaudio/codec-tests/mp3/128kbps-44khz-expected.wav: Removed.
        * platform/ios/webaudio/codec-tests/vorbis/vbr-128kbps-44khz-expected.txt: Removed.
        * platform/ios/webaudio/codec-tests/vorbis/vbr-96kbps-44khz-expected.txt: Removed.
        * platform/ios/webaudio/codec-tests/wav/24bit-22khz-resample-expected.wav: Removed.
        * platform/ios/webaudio/convolver-setBuffer-null-expected.txt: Removed.
        * platform/ios/webaudio/decode-audio-data-basic-expected.txt: Removed.
        * platform/ios/webaudio/delaynode-maxdelaylimit-expected.txt: Removed.
        * platform/ios/webaudio/distance-exponential-expected.txt: Removed.
        * platform/ios/webaudio/distance-inverse-expected.txt: Removed.
        * platform/ios/webaudio/distance-linear-expected.txt: Removed.
        * platform/ios/webaudio/javascriptaudionode-expected.txt: Removed.
        * platform/ios/webaudio/mediaelementaudiosourcenode-expected.txt: Removed.
        * platform/ios/webaudio/note-grain-on-play-expected.txt: Removed.
        * platform/ios/webaudio/note-grain-on-timing-expected.txt: Removed.
        * platform/ios/webaudio/oscillator-basic-expected.txt: Removed.
        * platform/ios/webaudio/oscillator-custom-expected.wav: Removed.
        * platform/ios/webaudio/oscillator-ended-expected.txt: Removed.
        * platform/ios/webaudio/oscillator-sawtooth-expected.wav: Removed.
        * platform/ios/webaudio/oscillator-square-expected.wav: Removed.
        * platform/ios/webaudio/oscillator-triangle-expected.wav: Removed.
        * platform/ios/webaudio/pannernode-basic-expected.txt: Removed.
        * platform/ios/webaudio/realtimeanalyser-fft-sizing-expected.txt: Removed.

2022-03-15  Alan Bujtas  <zalan@apple.com>

        REGRESSION (r282737): `text-shadow` is clipped
        https://bugs.webkit.org/show_bug.cgi?id=237898
        <rdar://problem/90320701>

        Reviewed by Darin Adler.

        * fast/text/text-shadow-ink-overflow-missing-expected.html: Added.
        * fast/text/text-shadow-ink-overflow-missing.html: Added.

2022-03-15  Jean-Yves Avenard  <jya@apple.com>

        REGRESSION(r287249): [ Monterey wk2 ] media/media-source/media-webm-vorbis-partial.html is a constant text failure
        https://bugs.webkit.org/show_bug.cgi?id=236656
        rdar://88978504

        Reviewed by Eric Carlson.

        Update test expectations, they didn't get committed after the test got
        modified in bug 236211

        * media/media-source/media-webm-vorbis-partial-expected.txt:
        * platform/mac-wk1/TestExpectations:
        * platform/mac-wk2/TestExpectations:

2022-03-15  Patrick Griffis  <pgriffis@igalia.com>

        Add initial implementation of Fetch Metadata
        https://bugs.webkit.org/show_bug.cgi?id=204744

        Reviewed by Youenn Fablet.

        Skip fewer of the Fetch Metadata tests. Many still timeout and are still
        being worked on.

        * TestExpectations:
        * http/wpt/fetch/fetch-metadata-same-origin-redirect-expected.txt: Added.
        * http/wpt/fetch/fetch-metadata-same-origin-redirect.html: Added.
        * platform/mac-wk1/TestExpectations:
        * platform/mac-wk1/imported/w3c/web-platform-tests/fetch/metadata/fetch-preflight.https.sub.any-expected.txt: Added.

2022-03-15  Matteo Flores  <matteo_flores@apple.com>

        [ iOS ] ASSERTION FAILED: m_isWaitingForDidUpdateGeometry on accessibility/visible-character-range.html
        https://bugs.webkit.org/show_bug.cgi?id=237557

        Unreviewed test gardening.

        * platform/ios-simulator-wk2/TestExpectations:

2022-03-15  Lauro Moura  <lmoura@igalia.com>

        [GLIB] Unreviewed gardening
        https://bugs.webkit.org/show_bug.cgi?id=237902

        * platform/glib/TestExpectations:
        * platform/gtk/TestExpectations:
        * platform/wpe/TestExpectations:

2022-03-15  Matteo Flores  <matteo_flores@apple.com>

        A combination of scrolling and a content change can leave a fixed layer in the wrong place
        https://bugs.webkit.org/show_bug.cgi?id=203112

        Unreviewed test gardening.

        * platform/ios-simulator-wk2/TestExpectations:

2022-03-15  Matteo Flores  <matteo_flores@apple.com>

        Implement ElementInternals
        https://bugs.webkit.org/show_bug.cgi?id=197960

        Unreviewed test gardening.

        * platform/ipad/TestExpectations:

2022-03-15  Matteo Flores  <matteo_flores@apple.com>

        [GPU Process] Test failures in writing modes
        https://bugs.webkit.org/show_bug.cgi?id=236921

        Unreviewed test gardening.

        * gpu-process/TestExpectations:

2022-03-15  Matteo Flores  <matteo_flores@apple.com>

        REGRESSION: [ iOS release wk2 ] compositing/debug-borders-dynamic.html is a flaky image failure
        https://github.com/Smackteo

        Unreviewed test gardening.

        * platform/ios-wk2/TestExpectations:

2022-03-15  Gabriel Nava Marino  <gnavamarino@apple.com>

        Crash in KeyframeList.cpp:183 in WebCore::KeyframeList::fillImplicitKeyframes
        https://bugs.webkit.org/show_bug.cgi?id=237858

        Reviewed by Antoine Quint.

        * animations/fill-implicit-keyframes-crash-expected.txt: Added.
        * animations/fill-implicit-keyframes-crash.html: Added.

2022-03-15  Youenn Fablet  <youenn@apple.com>

        Make sure to end any pending AudioSession interruption when activating it
        https://bugs.webkit.org/show_bug.cgi?id=237654
        <rdar://88405081>

        Reviewed by Eric Carlson.

        * platform/ios/mediastream/getUserMedia-override-audio-session-interruption-expected.txt: Added.
        * platform/ios/mediastream/getUserMedia-override-audio-session-interruption.html: Added.

2022-03-15  Youenn Fablet  <youenn@apple.com>

        AudioContext stops playing when minimizing or moving the macOS Safari window to the background.
        https://bugs.webkit.org/show_bug.cgi?id=231105
        <rdar://problem/83889697>

        Reviewed by Eric Carlson.

        Use internals API to be working on iOS as well (this does not trigger enterBackground code path).

        * webaudio/silent-audio-interrupted-in-background-expected.txt:
        * webaudio/silent-audio-interrupted-in-background.html:

2022-03-14  Lauro Moura  <lmoura@igalia.com>

        [GLIB] Unreviewed, gardening crash and timeout
        https://bugs.webkit.org/show_bug.cgi?id=237873

        * platform/glib/TestExpectations:

2022-03-14  Robert Jenner  <Jenner@apple.com>

        [ Mac wk1 ] 8X imported/w3c/web-platform-tests/pointerevents/pointere vent (layout-tests) are flaky text failures (236128)
        https://bugs.webkit.org/show_bug.cgi?id=236128

        Unreviewed test gardening.

        * platform/mac-wk1/TestExpectations: Disabling test that is believed to cause the others to fail as a test.

2022-03-14  Robert Jenner  <Jenner@apple.com>

        WindowServer returned not alive with context:,unresponsive work processor(s)
        <rdar://86037417>

        Uneviewed test gardening.

        * platform/ios-wk2/TestExpectations:
        * platform/mac-wk2/TestExpectations:

2022-03-14  Antoine Quint  <graouts@webkit.org>

        [model] <model interactive> doesn't allow model to be rotated on iOS
        https://bugs.webkit.org/show_bug.cgi?id=237831
        rdar://89698247

        Reviewed by Simon Fraser.

        Add a test where the <model> element is added to the DOM with the "interactive"
        HTML attribute already set.

        * model-element/model-element-interactive-dragging-expected.txt:
        * model-element/model-element-interactive-dragging.html:
        * model-element/resources/model-utils.js:
        (const.makeModel):
        (const.readyModel.async test):

2022-03-14  Oriol Brufau  <obrufau@igalia.com>

        [css] Implement 'text-decoration' as a shorthand.
        https://bugs.webkit.org/show_bug.cgi?id=237175

        Reviewed by Darin Adler.

        Update tests to take into account that 'text-decoration' is a shorthand.

        * fast/css/getComputedStyle/computed-style-expected.txt:
        * fast/css/getComputedStyle/computed-style-without-renderer-expected.txt:
        * fast/css/getComputedStyle/getComputedStyle-text-decoration-expected.txt:
        * fast/css/getComputedStyle/getComputedStyle-text-decoration.html:
        * fast/css/getComputedStyle/resources/property-names.js:
        * fast/css3-text/css3-text-decoration/getComputedStyle/getComputedStyle-text-decoration-shorthand-expected.txt:
        * fast/css3-text/css3-text-decoration/getComputedStyle/getComputedStyle-text-decoration-shorthand.html:
        * svg/css/getComputedStyle-basic-expected.txt:

2022-03-14  Antoine Quint  <graouts@webkit.org>

        [model] model-element/model-element-camera.html fails due to `promise_rejects` being undefined
        https://bugs.webkit.org/show_bug.cgi?id=237833
        rdar://88982597

        Unreviewed test fix after testharness.js was updated in bug 235398 but neglected to update this
        test to use promise_rejects_dom.

        * model-element/model-element-camera.html:

2022-03-14  Matteo Flores  <matteo_flores@apple.com>

        [GTK][WPE] EXIF orientation tests are failing since added in r249364 - "EXIF orientation should be respected when rendering images"
        https://bugs.webkit.org/show_bug.cgi?id=201982

        Unreviewed test gardening.

        * platform/ios/TestExpectations:

2022-03-14  Matteo Flores  <matteo_flores@apple.com>

        [ iOS iPhone 12 ] fast/hidpi & fast/layers/hidpi tests are flaky text/image failing
        https://bugs.webkit.org/show_bug.cgi?id=232384

        Unreviewed test gardening.

        * platform/ios/TestExpectations:

2022-03-14  Enrique Ocaña González  <eocanha@igalia.com>

        [MSE][SourceBuffer] Fix removal of paddings from buffered range
        https://bugs.webkit.org/show_bug.cgi?id=237780

        Reviewed by Jer Noble.

        This tests that overlapped samples in the boundaries of removal ranges aren't leaked.

        This patch is authored by Eugene Mutavchi <Ievgen_Mutavchi@comcast.com>
        See: https://github.com/WebPlatformForEmbedded/WPEWebKit/pull/797

        * media/media-source/media-source-remove-overlapped-expected.txt: Added.
        * media/media-source/media-source-remove-overlapped.html: Added.

2022-03-14  Youenn Fablet  <youenn@apple.com>

        [ MacOS ] imported/w3c/web-platform-tests/webrtc-extensions/transfer-datachannel.html is a flaky failure
        https://bugs.webkit.org/show_bug.cgi?id=230116
        <rdar://problem/82936812>

        Unreviewed.

        * platform/mac/TestExpectations:
        Unflake test now that is passing consistently on bots.

2022-03-14  Youenn Fablet  <youenn@apple.com>

        [BigSur wk2] http/tests/fetch/redirectmode-and-preload.html is a flaky failure
        https://bugs.webkit.org/show_bug.cgi?id=230112
        <rdar://problem/82932781>

        Unreviewed.

        * platform/mac-wk2/TestExpectations:
        Unflake test now that is passing consistently on bots.

2022-03-14  Youenn Fablet  <youenn@apple.com>

        [ BigSur wk2 arm64 ] 4 webrtc/ Layout-tests are consistently timing out
        https://bugs.webkit.org/show_bug.cgi?id=223043
        <rdar://problem/75280718>

        Unreviewed.

        * platform/mac/TestExpectations:
        Unflake tests now that are passing consistently on bots.

2022-03-12  Jean-Yves Avenard  <jya@apple.com>

        Safari produces scrambled output for some webm videos with vp8 codec.
        https://bugs.webkit.org/show_bug.cgi?id=236754

        Reviewed by Eric Carlson.

        VP8 files were generated such that alternative reference frames were used:
        $ fmpeg -i dragon.webm -c:v libvpx -vf scale=320:-1 -auto-alt-ref 1 -arnr-maxframes 5 -arnr-strength 3 -pass 1 test-vp8-hiddenframes.webm
        $ fmpeg -i dragon.webm -c:v libvpx -vf scale=320:-1 -auto-alt-ref 1 -arnr-maxframes 5 -arnr-strength 3 -pass 2 test-vp8-hiddenframes.webm

        The command used to extract the last frame in png format was:
        $ ffmpeg -sseof -3 -i test-vp8-hiddenframes.webm -pred mixed -pix_fmt rgb24 -sws_flags +accurate_rnd+full_chroma_int -update 1 -q:v 1 test-vp8-hiddenframes.png

        * TestExpectations:
        * media/content/test-vp8-hiddenframes.png: Added.
        * media/content/test-vp8-hiddenframes.webm: Added.
        * media/media-source/media-source-vp8-hiddenframes-expected.html: Added.
        * media/media-source/media-source-vp8-hiddenframes.html: Added.
        * media/media-vp8-hiddenframes-expected.html: Added.
        * media/media-vp8-hiddenframes.html: Added.
        * media/utilities.js: Added.
        (once):
        (fetchWithXHR):
        (loadSegment):

2022-03-11  Nikolaos Mouchtaris  <nmouchtaris@apple.com>

        [iOS] Fix ovserscroll-behavior for main document
        https://bugs.webkit.org/show_bug.cgi?id=237696

        Reviewed by Simon Fraser.

        Added test that does a scroll expecting a rubberband, sets overscroll-behavior:none for 
        the body, then does another scroll, expected that no rubberband occurs.

        * fast/scrolling/ios/overscroll-behavior-on-body-expected.txt: Added.
        * fast/scrolling/ios/overscroll-behavior-on-body.html: Added.

2022-03-11  Matteo Flores  <matteo_flores@apple.com>

        [ iOS ] fast/events/ios/rotation/layout-viewport-during-safari-type-rotation.html is flaky failing
        https://bugs.webkit.org/show_bug.cgi?id=231266

        Unreviewed test gardening.

        * platform/ios-wk2/TestExpectations:

2022-03-11  Alan Bujtas  <zalan@apple.com>

        [iOS] Unreviewed gardening after r291169.

        * platform/ios/fast/dynamic/insert-before-table-part-in-continuation-expected.txt:

2022-03-11  J Pascoe  <j_pascoe@apple.com>

        [WebAuthn] Support authenticatorSelection.residentKey ResidentKeyRequirement
        https://bugs.webkit.org/show_bug.cgi?id=237567
        rdar://89788378

        Reviewed by Brent Fulgham and Chris Dumez.

        Add layout tests using residentKey field.

        * http/wpt/webauthn/public-key-credential-create-failure-hid.https-expected.txt:
        * http/wpt/webauthn/public-key-credential-create-failure-hid.https.html:
        * http/wpt/webauthn/public-key-credential-create-success-hid.https-expected.txt:
        * http/wpt/webauthn/public-key-credential-create-success-hid.https.html:

2022-03-11  Don Olmstead  <don.olmstead@sony.com>

        Platforms implementing WebSocketTask pass hybi/close-and-server-script-exception-expected.txt
        https://bugs.webkit.org/show_bug.cgi?id=237727

        Reviewed by Alex Christensen.

        The root expected.txt had a line with FAIL but all platforms that implement WebSocketTask
        PASS the test fully. Make this the default and remove redundant expectations and add a
        FAIL for Apple WebKitLegacy ports which don't implement WebSocketTask.

        * http/tests/websocket/tests/hybi/close-and-server-script-exception-expected.txt:
        * platform/glib/http/tests/websocket/tests/hybi/close-and-server-script-exception-expected.txt: Removed.
        * platform/ios-wk2/http/tests/websocket/tests/hybi/close-and-server-script-exception-expected.txt: Removed.
        * platform/mac-wk1/http/tests/websocket/tests/hybi/close-and-server-script-exception-expected.txt: Copied from LayoutTests/http/tests/websocket/tests/hybi/close-and-server-script-exception-expected.txt.
        * platform/mac-wk2/http/tests/websocket/tests/hybi/close-and-server-script-exception-expected.txt: Removed.
        * platform/win/http/tests/websocket/tests/hybi/close-and-server-script-exception-expected.txt: Copied from LayoutTests/http/tests/websocket/tests/hybi/close-and-server-script-exception-expected.txt.

2022-03-11  Alan Bujtas  <zalan@apple.com>

        [IFC][Integration] Add support for inline table
        https://bugs.webkit.org/show_bug.cgi?id=237498

        Reviewed by Antti Koivisto.

        * platform/mac/fast/dynamic/insert-before-table-part-in-continuation-expected.txt:

2022-03-11  Youenn Fablet  <youenn@apple.com>

        Do capture video frame downsampling in GPUProcess
        https://bugs.webkit.org/show_bug.cgi?id=237316
        <rdar://problem/89959777>

        Reviewed by Eric Carlson.

        * fast/mediastream/getDisplayMedia-size.html:
        Remove potential race condition by restarting playing the stream to compute the size.

2022-03-10  Frédéric Wang  <fwang@igalia.com>

        [ iOS ] editing/inserting/insert-paragraph-separator-with-inline-table-bold-crash.html is a flaky timeout
        https://bugs.webkit.org/show_bug.cgi?id=237551

        Reviewed by Ryosuke Niwa.

        * editing/inserting/insert-paragraph-separator-with-inline-table-bold-crash.html: Ensure the
        test does not complete before the page load.

2022-03-10  Peng Liu  <peng.liu6@apple.com>

        EnterPictureInPictureEvent event was renamed to PictureInPictureEvent in spec
        https://bugs.webkit.org/show_bug.cgi?id=221083

        Reviewed by Youenn Fablet.

        * media/picture-in-picture/picture-in-picture-api-events-expected.txt:
        * media/picture-in-picture/picture-in-picture-api-events.html:
        Check the picture-in-picture window in the "leavepictureinpicture" event handler.

2022-03-10  Chris Dumez  <cdumez@apple.com>

        Main document is leaking on haaretz.co.il due to lazy image loading
        https://bugs.webkit.org/show_bug.cgi?id=237660
        <rdar://problem/90035071>

        Reviewed by Geoffrey Garen.

        Add layout test coverage.

        * fast/dom/lazy-image-loading-document-leak-expected.txt: Added.
        * fast/dom/lazy-image-loading-document-leak.html: Added.
        * fast/dom/resources/lazy-image-loading-document-leak-popup.html: Added.

2022-03-10  Matteo Flores  <matteo_flores@apple.com>

        [ iOS Mac ] imported/w3c/web-platform-tests/service-workers/service-worker/partitioned-service-worker-matchAll.tentative.https.html is a flaky text failure on all queues
        https://bugs.webkit.org/show_bug.cgi?id=237680

        Unreviewed test gardening.

        * platform/ios/TestExpectations:
        * platform/mac/TestExpectations:

2022-03-10  Alan Bujtas  <zalan@apple.com>

        [IFC][Integration] Enable RenderListItem and RenderListMarker for IFC
        https://bugs.webkit.org/show_bug.cgi?id=237497

        Reviewed by Antti Koivisto.

        * fast/replaced/ul-li-word-break-break-word-expected.html: progression. We do not break between the list marker and the content anymore.
        * platform/mac/css1/box_properties/margin_right-expected.txt:
        * platform/mac/css1/box_properties/padding_right-expected.txt: ^^progressions. Align list marker with the content (like Firefox does).
        * platform/mac/css2.1/t0505-c16-descendant-01-e-expected.txt: inline box height progression (not visible)
        * platform/mac/fast/dom/HTMLProgressElement/progress-bar-value-pseudo-element-expected.txt: usual 1px diff.
        * platform/mac/fast/inline/emptyInlinesWithinLists-expected.txt: progression
        * platform/mac/fast/lists/002-expected.txt: same as margin_right/padding_right. 
        * platform/mac/fast/lists/003-expected.txt: ^^
        * platform/mac/fast/lists/li-br-expected.txt: same as ul-li-word-break-break-word
        * platform/mac/fast/selectors/166-expected.txt: usual 1px diff.

2022-03-10  Alex Christensen  <achristensen@webkit.org>

        Remove unused iOS 14 test results

        * platform/ios-14: Removed.
        * platform/ios-14-wk2: Removed.

2022-03-10  Jon Lee  <jonlee@apple.com>

        Unreviewed gardening.

        * platform/ios/TestExpectations: r291034 fixed platform/ios/mediastream/audio-muted-in-background-tab-gpu-process.html.

2022-03-10  Chris Fleizach  <cfleizach@apple.com>

        AX: Support updated WebSpeech API
        https://bugs.webkit.org/show_bug.cgi?id=237614
        <rdar://problem/89981851>

        Reviewed by Andres Gonzalez.

        Fixed expectations:
        * imported/w3c/web-platform-tests/speech-api/SpeechSynthesisEvent-constructor-expected.txt: Updated.
        * imported/w3c/web-platform-tests/speech-api/SpeechSynthesisErrorEvent-constructor-expected.txt: Updated.
        * fast/speechsynthesis/speech-synthesis-boundary-events.html: Updated.
        * fast/speechsynthesis/speech-synthesis-boundary-events-expected.txt: Updated.

2022-03-10  Antoine Quint  <graouts@webkit.org>

        [web-animations] font-variant-caps should support discrete animation
        https://bugs.webkit.org/show_bug.cgi?id=237662

        Reviewed by Myles C. Maxfield.

        * platform/gtk/imported/w3c/web-platform-tests/css/css-fonts/animations/system-fonts-expected.txt:
        * platform/ios/imported/w3c/web-platform-tests/css/css-fonts/animations/system-fonts-expected.txt:

2022-03-10  Jer Noble  <jer.noble@apple.com>

        [iOS] Netflix.com fails to resume after moving app to background during playback
        https://bugs.webkit.org/show_bug.cgi?id=237659
        <rdar://88775037>

        Reviewed by Eric Carlson.

        * media/media-source/media-source-interruption-with-resume-allowing-play-expected.txt: Added.
        * media/media-source/media-source-interruption-with-resume-allowing-play.html: Added.

2022-03-10  Philippe Normand  <pnormand@igalia.com>

        REGRESSION(r284711): [GStreamer] Buffering, seek broken on youtube.com
        https://bugs.webkit.org/show_bug.cgi?id=233861

        Unreviewed, manual revert of 284711.

        * platform/glib/imported/w3c/web-platform-tests/media-source/mediasource-remove-expected.txt:

2022-03-10  Philippe Normand  <pnormand@igalia.com>

        Unreviewed GStreamer gardening

        * platform/glib/TestExpectations: media/video-src-blob-perf.html is failing actually.

2022-03-10  Lauro Moura  <lmoura@igalia.com>

        Add context.roundRect support to OffScreenCanvas
        https://bugs.webkit.org/show_bug.cgi?id=232780
        <rdar://problem/85366210>

        Reviewed by Darin Adler.

        * inspector/canvas/recording-2d-full-expected.txt:
        * inspector/canvas/resources/recording-2d.js: Added calls to roundRect
        to test the inspector processArgument()
        * platform/glib/TestExpectations:
        * platform/gtk/imported/w3c/web-platform-tests/html/canvas/offscreen/drawing-images-to-the-canvas/2d.drawImage.zerosource.image-expected.txt: Removed.
        * platform/gtk/imported/w3c/web-platform-tests/html/canvas/offscreen/drawing-images-to-the-canvas/2d.drawImage.zerosource.worker-expected.txt: Removed.
        * platform/gtk/imported/w3c/web-platform-tests/html/dom/idlharness.https-expected.txt:
        * platform/gtk/imported/w3c/web-platform-tests/html/dom/idlharness.worker-expected.txt:
        * platform/ios-wk2/imported/w3c/web-platform-tests/html/dom/idlharness.https-expected.txt:
        * platform/ipad/imported/w3c/web-platform-tests/html/dom/idlharness.https-expected.txt:
        * platform/mac-wk1/imported/w3c/web-platform-tests/html/dom/idlharness.https-expected.txt:
        * platform/wpe/imported/w3c/web-platform-tests/html/canvas/offscreen/drawing-images-to-the-canvas/2d.drawImage.zerosource.image-expected.txt: Removed.
        * platform/wpe/imported/w3c/web-platform-tests/html/canvas/offscreen/drawing-images-to-the-canvas/2d.drawImage.zerosource.worker-expected.txt: Removed.
        * platform/wpe/imported/w3c/web-platform-tests/html/dom/idlharness.https-expected.txt:
        * platform/wpe/imported/w3c/web-platform-tests/html/dom/idlharness.worker-expected.txt: Renamed from LayoutTests/platform/glib/imported/w3c/web-platform-tests/html/dom/idlharness.worker-expected.txt.

2022-03-10  Nikolas Zimmermann  <nzimmermann@igalia.com>

        Cleanup RenderLayer::currentTransform()
        https://bugs.webkit.org/show_bug.cgi?id=237553

        Reviewed by Rob Buis.

        Mark new WPT test css/css-transforms/animation/transform-box-will-change-transform-layer.html
        as expected to fail, since 'transform-box' is ignored for composited elements at the moment.

        * platform/glib/TestExpectations:
        * platform/ios/TestExpectations:
        * platform/mac/TestExpectations:
        * platform/win/TestExpectations:

2022-03-09  Cameron McCormack  <heycam@apple.com>

        Unreviewed test gardening
        https://bugs.webkit.org/show_bug.cgi?id=237688

        * gpu-process/TestExpectations:
        * svg/W3C-SVG-1.2-Tiny/struct-use-recursion-01-t.svg:

2022-03-09  Cameron McCormack  <heycam@apple.com>

        Unreviewed test gardening
        https://bugs.webkit.org/show_bug.cgi?id=236931

        * gpu-process/TestExpectations:

2022-03-09  Cameron McCormack  <heycam@apple.com>

        Unreviewed test gardening
        https://bugs.webkit.org/show_bug.cgi?id=236930

        * gpu-process/TestExpectations:
        * platform/ios/TestExpectations:

2022-03-09  Matt Woodrow  <mattwoodrow@apple.com>

        Empty float rects should remain empty after integrally enclosing them.
        https://bugs.webkit.org/show_bug.cgi?id=237507

        Reviewed by Alan Bujtas.

        * compositing/tile-coverage-subpixel-empty-rect-expected.txt: Added.
        * compositing/tile-coverage-subpixel-empty-rect.html: Added.
        * platform/gtk/compositing/tile-coverage-subpixel-empty-rect-expected.txt: Added.
        * platform/ios/compositing/tile-coverage-subpixel-empty-rect-expected.txt: Added.

        Adds a new test that uses multiple overflow:hidden clips and absolute positioning to create
        an empty coverage rect with a subpixel x/y position that is within the bounds of an offscreen
        layer. Confirms that we don't accidentally allocate a tile for this layer.

2022-03-09  Matteo Flores  <matteo_flores@apple.com>

        Unreviewed, reverting r290750.

        Bug has been fixed, expectations are no longer needed.

        Reverted changeset:

        "[ iOS Debug ] editing/async-clipboard/* 20 tests are flaky
        timeouts on iOS."
        https://bugs.webkit.org/show_bug.cgi?id=237372
        https://commits.webkit.org/r290750

2022-03-09  Matteo Flores  <matteo_flores@apple.com>

        [ iOS ] 2 imported/w3c/web-platform-tests/content-security-policy/connect-src/* tests are flaky text failures
        https://bugs.webkit.org/show_bug.cgi?id=237603

        Unreviewed test gardening.

        * platform/ios/TestExpectations:

2022-03-09  Matteo Flores  <matteo_flores@apple.com>

        [iOS] Hard link AVPictureInPictureController
        https://bugs.webkit.org/show_bug.cgi?id=237227

        Unreviewed test gardening.

        * platform/ipad/TestExpectations:

2022-03-09  Jon Lee  <jonlee@apple.com>

        Unreviewed gardening.

        * platform/ios-wk2/TestExpectations:

2022-03-09  Youenn Fablet  <youenn@apple.com>

        WebRTC decoded frames are not correctly rotated in case GPU Process DOM rendering flag is set to true
        https://bugs.webkit.org/show_bug.cgi?id=237468
        <rdar://problem/89807876>

        Reviewed by Eric Carlson.

        * webrtc/video-rotation.html:
        Observe actual video frame rotation value.

2022-03-08  Antoine Quint  <graouts@webkit.org>

        [web-animations] font-family should support discrete animation
        https://bugs.webkit.org/show_bug.cgi?id=237591

        Reviewed by Myles Maxfield.

        * platform/gtk/imported/w3c/web-platform-tests/css/css-fonts/animations/system-fonts-expected.txt:
        * platform/ios/imported/w3c/web-platform-tests/css/css-fonts/animations/system-fonts-expected.txt:

2022-03-09  Antti Koivisto  <antti@apple.com>

        [CSS Container Queries] Import updated WPTs
        https://bugs.webkit.org/show_bug.cgi?id=237638

        Reviewed by Antoine Quint.

        * TestExpectations:

2022-03-09  Youenn Fablet  <youenn@apple.com>

        Scope capture sources by page identifiers
        https://bugs.webkit.org/show_bug.cgi?id=237359

        Reviewed by Eric Carlson.

        Remove platform/ios/mediastream/getUserMedia-single-capture.html now that we no longer handle multi capture in WebProcess but in GPUProcess.
        Update platform/ios/mediastream/audio-muted-in-background-tab-gpu-process.html to be like platform/ios/mediastream/audio-muted-in-background-tab.html
        so that test is no longer dependent on synchronous event firing.

        * platform/ios/mediastream/audio-muted-in-background-tab-gpu-process.html:
        * platform/ios/mediastream/getUserMedia-single-capture-expected.txt: Removed.
        * platform/ios/mediastream/getUserMedia-single-capture-gpu-process.html:
        * platform/ios/mediastream/getUserMedia-single-capture.html: Removed.

2022-03-08  John Cunningham  <johncunningham@apple.com>

        RemoteGraphicsContextGL ReadPixels does not preserve contents for area that is not part of the Framebuffer
        https://bugs.webkit.org/show_bug.cgi?id=222410
        <rdar://problem/75025951>

        Reviewed by Kimmo Kinnunen.

        Don't overwrite the data buffer for readPixels

        * platform/ios-wk2/TestExpectations:

2022-03-08  Chris Dumez  <cdumez@apple.com>

        IntersectionObserver is causing massive document leaks on haaretz.co.il
        https://bugs.webkit.org/show_bug.cgi?id=237619
        <rdar://problem/89989815>

        Reviewed by Simon Fraser.

        Add layout test coverage.

        * fast/dom/intersection-observer-document-leak-expected.txt: Added.
        * fast/dom/intersection-observer-document-leak.html: Added.
        * fast/dom/resources/intersection-observer-document-leak-popup.html: Added.

2022-03-08  Eric Carlson  <eric.carlson@apple.com>

        [Cocoa] metadata cue endTime may not be updated
        https://bugs.webkit.org/show_bug.cgi?id=237630
        rdar://88690874

        Reviewed by Jer Noble.

        * http/tests/media/hls/track-in-band-hls-metadata-cue-duration-expected.txt: Added.
        * http/tests/media/hls/track-in-band-hls-metadata-cue-duration.html: Added.

2022-03-08  J Pascoe  <j_pascoe@apple.com>

        [WebAuthn] Using WebAuthn within cross-origin iframe elements
        https://bugs.webkit.org/show_bug.cgi?id=222240
        rdar://problem/74830748

        Reviewed by Brent Fulgham.

        Update existing tests and create new test for cross-origin, non same-site i-frames.

        * http/wpt/webauthn/public-key-credential-cross-origin.https-expected.txt: Added.
        * http/wpt/webauthn/public-key-credential-cross-origin.https.html: Added.
        * http/wpt/webauthn/public-key-credential-same-origin-with-ancestors.https-expected.txt:
        * http/wpt/webauthn/public-key-credential-same-origin-with-ancestors.https.html:
        * http/wpt/webauthn/resources/public-key-credential-cross-origin.https.html: Added.

2022-03-08  Chris Fleizach  <cfleizach@apple.com>

        AX: Speech Synthesis no longer returning list of voices in macOS 12.3
        https://bugs.webkit.org/show_bug.cgi?id=237584
        <rdar://problem/89952347>

        Reviewed by Andres Gonzalez.

        * fast/speechsynthesis/voices-non-mock-expected.txt: Added.
        * fast/speechsynthesis/voices-non-mock.html: Added.

2022-03-08  Chris Dumez  <cdumez@apple.com>

        Unreviewed, silence console logging for http/tests/security/cookie-module-import-propagate.html
        <rdar://88842347>

        This is to address flakiness on the bots.

        * TestExpectations:
        * http/tests/security/cookie-module-import-propagate-expected.txt:

2022-03-08  J Pascoe  <j_pascoe@apple.com>

        [ iOS ] 2X http/wpt/webauthn/public-key-credential-create-failure-local (layout-tests) are constant text failures
        https://bugs.webkit.org/show_bug.cgi?id=237548
        rdar://problem/89923849

        Unreviewed test gardening.

        These console messages differing is causing test failures, fixing expectations.

        * http/wpt/webauthn/public-key-credential-create-failure-local-silent.https-expected.txt:
        * http/wpt/webauthn/public-key-credential-create-failure-local.https-expected.txt:

2022-03-08  Youenn Fablet  <youenn@apple.com>

        Add a preference to mute video capture in case audio capture gets interrupted
        https://bugs.webkit.org/show_bug.cgi?id=237524
        <rdar://78421282>

        Reviewed by Eric Carlson.

        * fast/mediastream/media-stream-video-track-interrupted-from-audio-expected.txt: Added.
        * fast/mediastream/media-stream-video-track-interrupted-from-audio.html: Added.
        * fast/mediastream/media-stream-video-track-interrupted.html: Migrated to testRunner API.
        * fast/mediastream/track-ended-while-muted.html:
        * platform/glib/TestExpectations:

2022-03-08  Youenn Fablet  <youenn@apple.com>

        Improve WebRTC VPX media capabilities accuracy
        https://bugs.webkit.org/show_bug.cgi?id=237462

        Reviewed by Eric Carlson.

        * webrtc/video-mute-vp8.html:
        * webrtc/vp9-expected.txt:
        * webrtc/vp9.html:

2022-03-08  Chris Dumez  <cdumez@apple.com>

        Resync web-platform-tests/beacon from upstream
        https://bugs.webkit.org/show_bug.cgi?id=237536

        Unreviewed, drop web-platform-tests/beacon tests that are no longer upstream.

        * TestExpectations:

2022-03-07  Andres Gonzalez  <andresg_22@apple.com>

        Fix for <select> elements in isolated tree mode.
        https://bugs.webkit.org/show_bug.cgi?id=237483
        rdar://89530022

        Reviewed by Chris Fleizach.

        * accessibility/dropdown-value-expected.txt: Added.
        * accessibility/dropdown-value.html: Added.

2022-03-07  Mark Lam  <mark.lam@apple.com>

        Remove TestExpectations for imported/w3c/web-platform-tests/IndexedDB/key-generators/reading-autoincrement-indexes-cursors.any.worker.html.
        https://bugs.webkit.org/show_bug.cgi?id=229244

        Not reviewed.

        TestExpectaions says this test will either pass or crash.  However, the test history
        at https://results.webkit.org/?suite=layout-tests&test=imported%2Fw3c%2Fweb-platform-tests%2FIndexedDB%2Fkey-generators%2Freading-autoincrement-indexes-cursors.any.worker.html
        shows that this test hasn't crashed in a very long time.

        Also local runs of the test on AppleSilicon with Debug WK1 pass with no crash.

        * platform/mac/TestExpectations:

2022-03-07  Jon Lee  <jonlee@apple.com>

        Unreviewed gardening.

        * gpu-process/TestExpectations: Remove tests that were resolved by r290813.

2022-03-07  Oriol Brufau  <obrufau@igalia.com>

        Remove duplicated platform expectations for computed-style.html, computed-style-without-renderer.html, getComputedStyle-basic.xhtml
        https://bugs.webkit.org/show_bug.cgi?id=237534

        Unreviewed test gardening.

        * platform/glib/fast/css/getComputedStyle/computed-style-expected.txt: Removed.
        * platform/glib/fast/css/getComputedStyle/computed-style-without-renderer-expected.txt: Removed.
        * platform/glib/svg/css/getComputedStyle-basic-expected.txt: Removed.
        * platform/ios/fast/css/getComputedStyle/computed-style-expected.txt: Removed.
        * platform/ios/fast/css/getComputedStyle/computed-style-without-renderer-expected.txt: Removed.
        * platform/ios/svg/css/getComputedStyle-basic-expected.txt: Removed.

2022-03-07  Kimmo Kinnunen  <kkinnunen@apple.com>

        LayoutTests/webgl/max-active-contexts-gc.html is flaky
        https://bugs.webkit.org/show_bug.cgi?id=237466

        Reviewed by Alexey Proskuryakov.
        The test:
         - created 16 WebGL contexts
         - unreferenced 8 WebGL contexts.
         - forced gc
         - added 9 WebGL contexts.
        The test tries to test that GC removes unreferenced contexts.
        To assert this, it ends up with 17 contexts, which is 1 above
        the maximum active limit. This means one context is lost and the
        implementation prints one line of error.

        Since the GC is not exact, sometimes it would only collect 7 of the 8
        unreferenced contexts. This would mean two error messages.

        Fix by trying to collect each time a context is unreferenced. This seems to be
        more predictable.

        * webgl/max-active-contexts-gc.html:

2022-03-07  Chris Dumez  <cdumez@apple.com>

        Make "true" count as truthy in window.open()'s boolean features
        https://bugs.webkit.org/show_bug.cgi?id=237530

        Reviewed by Alex Christensen.

        * tests-options.json:

2022-03-07  Chris Dumez  <cdumez@apple.com>

        [Catalina Release wk1] imported/w3c/web-platform-tests/html/browsers/origin/cross-origin-objects/cross-origin-objects.html is a flaky failure
        https://bugs.webkit.org/show_bug.cgi?id=230729
        <rdar://problem/83469625>

        Unreviewed, unskip test as the bots show no recent flakiness.

        * platform/mac-wk1/TestExpectations:

2022-03-07  Antoine Quint  <graouts@webkit.org>

        Parsing of list-style shorthand is incorrect
        https://bugs.webkit.org/show_bug.cgi?id=237515

        Reviewed by Antti Koivisto.

        Some non-WPT tests had the wrong assumption on the shorthand order
        for list-style, so we update those tests to match the spec.

        Additionally, the WPT test css/css-lists/list-style-type-string-004.html now passes.

        * fast/css/cssText-shorthand-expected.txt:
        * fast/css/cssText-shorthand.html:
        * fast/css/getComputedStyle/getComputedStyle-list-style-shorthand-expected.txt:
        * fast/css/getComputedStyle/getComputedStyle-list-style-shorthand.html:
        * platform/mac/TestExpectations:

2022-03-07  Matt Woodrow  <mattwoodrow@apple.com>

        Compute correct containing block override size for items that are subgridden in one dimension only.
        https://bugs.webkit.org/show_bug.cgi?id=236951

        Reviewed by Dean Jackson.

        * TestExpectations:

        Marked existing WPT as passing.

2022-03-05  Alan Bujtas  <zalan@apple.com>

        Remove non-standard display:block UA stylesheet rule for <layer>
        https://bugs.webkit.org/show_bug.cgi?id=236730
        <rdar://problem/89372670>

        Reviewed by Antti Koivisto.

        * inspector/css/shadow-scoped-style-expected.txt:

2022-03-05  Alan Bujtas  <zalan@apple.com>

        [IFC][Integration] Do not bail out on IFC content with floats inside.
        https://bugs.webkit.org/show_bug.cgi?id=237494

        Reviewed by Antti Koivisto.

        * platform/ios/css2.1/t0905-c5525-fltcont-00-d-g-expected.txt:
        * platform/mac/css2.1/t0905-c5525-fltcont-00-d-g-expected.txt:

2022-03-05  Antti Koivisto  <antti@apple.com>

        Resolve ::first-line style eagerly
        https://bugs.webkit.org/show_bug.cgi?id=237362

        Reviewed by Alan Bujtas.

        * TestExpectations:
        * platform/mac/fast/forms/input-baseline-expected.txt:

2022-03-05  Youenn Fablet  <youenn@apple.com>

        Implement remote-inbound-rtp packetsLost
        https://bugs.webkit.org/show_bug.cgi?id=237443

        Reviewed by Eric Carlson.

        * platform/mac/TestExpectations:
        * webrtc/video-stats.html:

2022-03-04  Tyler Wilcock  <tyler_w@apple.com>

        AX: [WebAccessibilityObjectWrapperMac AXAttributeStringSetFont] crashes when given a font with a nil postscript name, font family, or display name
        https://bugs.webkit.org/show_bug.cgi?id=237373

        Reviewed by Chris Fleizach and Andres Gonzalez.

        * accessibility/resources/Litherum.svg: Added.
        * accessibility/svg-font-face-expected.txt: Added.
        * accessibility/svg-font-face.html: Added.
        * platform/glib/TestExpectations: Skip new test.
        * platform/ios/TestExpectations: Enable new test.
        * platform/win/TestExpectations: Skip new test.

        * platform/mac/accessibility/element-line-rects-and-text-expected.txt:
        Before this patch, [WebAccessibilityObjectWrapperBase AXAttributeStringSetStyle] called the iOS
        version of AXAttributeStringSetFont. This patch fixes this. The expectation for this test is updated as a result.

2022-03-04  Kate Cheney  <katherine_cheney@apple.com>

        about:blank iframes do not always inherit parent CSP
        https://bugs.webkit.org/show_bug.cgi?id=236347
        <rdar://problem/88669147>

        Reviewed by Brent Fulgham.

        * http/tests/security/contentSecurityPolicy/block-eval-onload-in-nested-about-blank-iframe-expected.txt: Added.
        * http/tests/security/contentSecurityPolicy/block-eval-onload-in-nested-about-blank-iframe.html: Added
        We can't use modern js-test.js and related functions because
        js-test.js uses eval() and loading it makes the test time out when the
        eval is blocked by the document's CSP. We can't specify unsafe-eval
        because the whole point of this test is to block eval.

2022-03-04  Robert Jenner  <Jenner@apple.com>

        Update WPT css-scroll-snap tests
        https://bugs.webkit.org/show_bug.cgi?id=237358

        Unreviewed test gardening.
        
        * platform/ios-wk2/TestExpectations:

2022-03-04  Chris Dumez  <cdumez@apple.com>

        Home link on weather.gov is not working
        https://bugs.webkit.org/show_bug.cgi?id=237451
        <rdar://60409277>

        Reviewed by Geoff Garen.

        Skip WPT tests that is timing out. I have verified that this WPT test is timing out in Blink as well.

        * TestExpectations:

2022-03-04  Chris Dumez  <cdumez@apple.com>

        Load event never firing after form is submitted
        https://bugs.webkit.org/show_bug.cgi?id=235407
        <rdar://problem/87831049>

        Reviewed by Geoffrey Garen.

        Add layout test coverage (Based on reduction from Sam Sneddon).

        * http/tests/loading/form-submission-no-load-event-expected.txt: Added.
        * http/tests/loading/form-submission-no-load-event.html: Added.

2022-03-04  Said Abou-Hallawa  <said@apple.com>

        [GPU Process] Canvas compositing buffer should be created through its GraphicsContext
        https://bugs.webkit.org/show_bug.cgi?id=237260
        rdar://89196918

        Reviewed by Simon Fraser.

        * gpu-process/TestExpectations:

2022-03-04  Kate Cheney  <katherine_cheney@apple.com>

        CSP report does not get sent to the document in the case of a detached element
        https://bugs.webkit.org/show_bug.cgi?id=237440
        <rdar://problem/89081463>

        Reviewed by Chris Dumez.

        * http/tests/security/contentSecurityPolicy/report-violation-to-document-after-element-has-been-detached-expected.txt: Added.
        * http/tests/security/contentSecurityPolicy/report-violation-to-document-after-element-has-been-detached.html: Added.

2022-03-04  Youenn Fablet  <youenn@apple.com>

        webrtc/canvas-to-peer-connection.html is flakily failing a test assertion
        https://bugs.webkit.org/show_bug.cgi?id=237423

        Reviewed by Eric Carlson.

        WebRTC pipeline is lossy so frames might disappear.
        For that reason, we need to send multiple times the same frame to ensure we can read the expected frame.
        To ensure we are not reading a previous test frame, what we do is changing the size of the canvas before doing the test.
        This patch reduces the number of iterations to ensure the test is not too long to run.

        * webrtc/canvas-to-peer-connection.html:

2022-03-03  Youenn Fablet  <youenn@apple.com>

        fast/mediastream/getUserMedia-to-canvas-1.html and fast/mediastream/getUserMedia-to-canvas-2.html are failing on MacOS when remote video frame flag is enabled
        https://bugs.webkit.org/show_bug.cgi?id=237042
        <rdar://problem/89298601>

        Reviewed by Eric Carlson.

        Video element videoWidth/videoHeight are updated when track settings are changed,
        and not when video frames being received.

        This does not guarantee that videoWidth/videoHeight (main thread) are fully in sync
        with the actual video frames (background thread) when there is a change of size.

        We might be able to tighten this in MediaPlayerPrivateMediaStreamAVFObjC by only resorting on video frames.
        In the meantime, we update the test to use requestVideoFrameCallback which provides accurate per frame metadata.

        * fast/mediastream/getUserMedia-to-canvas-1.html:
        * fast/mediastream/getUserMedia-to-canvas-2.html:
        * webrtc/routines.js:

2022-03-03  Kimmo Kinnunen  <kkinnunen@apple.com>

        WebGL context count is not limited for GPU process
        https://bugs.webkit.org/show_bug.cgi?id=222411

        Reviewed by Kenneth Russell.

        * platform/ios-wk2/TestExpectations:

2022-03-03  Ben Nham  <nham@apple.com>

        Enforce silent push quota
        https://bugs.webkit.org/show_bug.cgi?id=236863

        Reviewed by Brady Eidson.

        Update PushEvent tests to check that notifications are displayed.

        * http/wpt/push-api/pushEvent.any.js:
        (promise_test.async const):
        (promise_test.async if):
        * http/wpt/push-api/pushEvent.any.serviceworker-expected.txt:

2022-03-03  Simon Fraser  <simon.fraser@apple.com>

        Element with position: sticky after sticking, starts to move incorrectly when scrolling
        https://bugs.webkit.org/show_bug.cgi?id=231953
        <rdar://84662329>

        Reviewed by Sam Weinig.

        * platform/ios-wk2/scrollingcoordinator/scrolling-tree/sticky-in-overflow-stale-constraints-expected.txt: Added.
        * scrollingcoordinator/scrolling-tree/sticky-in-overflow-stale-constraints-expected.txt: Added.
        * scrollingcoordinator/scrolling-tree/sticky-in-overflow-stale-constraints.html: Added.

2022-03-03  Simon Fraser  <simon.fraser@apple.com>

        nasa.gov page with fixed backgrounds paints incorrectly on scroll
        https://bugs.webkit.org/show_bug.cgi?id=237405
        <rdar://66568551>

        Reviewed by Antti Koivisto.

        Repaint test which is only valid for mac-wk2 (iOS does not support background-attachment:fixed).

        * TestExpectations:
        * fast/repaint/background-attachment-fixed-in-composited-scroll-expected.txt: Added.
        * fast/repaint/background-attachment-fixed-in-composited-scroll.html: Added.
        * platform/mac-wk2/TestExpectations:

2022-03-03  Jon Lee  <jonlee@apple.com>

        Unreviewed test gardening.

        * gpu-process/TestExpectations:
        * platform/ios/TestExpectations:

2022-03-03  Alan Bujtas  <zalan@apple.com>

        A text node longer than 65,535 characters following another text node is invisible in a scrolling context
        https://bugs.webkit.org/show_bug.cgi?id=237330
        <rdar://problem/89645522>

        Reviewed by Antti Koivisto.

        * fast/text/text-overflow-over-64k-expected.html: Added.
        * fast/text/text-overflow-over-64k.html: Added.

2022-03-03  Youenn Fablet  <youenn@apple.com>

        macOS Safari 15.2 Audio Echo Issue after camera pause/unpause
        https://bugs.webkit.org/show_bug.cgi?id=235544
        <rdar://problem/88297045>

        Reviewed by Eric Carlson.

        * fast/mediastream/mediastreamtrack-audiovideo-mutepage-expected.txt: Added.
        * fast/mediastream/mediastreamtrack-audiovideo-mutepage.html: Added.

2022-03-03  Chris Dumez  <cdumez@apple.com>

        REGRESSION(r290356-r290351?): [ iOS EWS ] 3 imported/w3c/web-platform-tests/service-workers/service-worker/* tests are constant text failures.
        https://bugs.webkit.org/show_bug.cgi?id=237160
        <rdar://problem/89440067>

        Reviewed by Youenn Fablet.

        Unskip tests that are no longer failing.

        * platform/ios/TestExpectations:

2022-03-03  Martin Robinson  <mrobinson@webkit.org>

        Update WPT css-scroll-snap tests
        https://bugs.webkit.org/show_bug.cgi?id=237358

        Reviewed by Manuel Rego Casasnovas.

        * platform/glib/imported/w3c/web-platform-tests/css/css-scroll-snap/scroll-target-margin-005-expected.txt: Added.
        * platform/mac-wk1/imported/w3c/web-platform-tests/css/css-scroll-snap/scroll-target-margin-005-expected.txt: Added.

2022-03-03  Commit Queue  <commit-queue@webkit.org>

        Unreviewed, reverting r290756.
        https://bugs.webkit.org/show_bug.cgi?id=237412

        Speedometer2

        Reverted changeset:

        "[css] Implement 'text-decoration' as a shorthand."
        https://bugs.webkit.org/show_bug.cgi?id=237175
        https://commits.webkit.org/r290756

2022-03-02  Sihui Liu  <sihui_liu@apple.com>

        Throw proper exception on failed removeEntry() calls
        https://bugs.webkit.org/show_bug.cgi?id=237382
        <rdar://89232969>

        Reviewed by Chris Dumez.

        * storage/filesystemaccess/handle-move-expected.txt:
        * storage/filesystemaccess/handle-move-worker-expected.txt:
        * storage/filesystemaccess/resources/handle-move.js:
        (async test):

2022-03-02  Robert Jenner  <Jenner@apple.com>

        WindowServer returned not alive with context:,unresponsive work processor(s)
        <rdar://86037417>

        Unreviewed test gardening. Skipping tests on iOS due to tests causing WindowServer to crash.

        * platform/ios-wk2/TestExpectations:

2022-03-02  Robert Jenner  <Jenner@apple.com>

        Unreviewed, reverting r290658.

        r290658 broke two tests for iOS, slowing down EWS.

        Reverted changeset:

        "fast/mediastream/getUserMedia-to-canvas-1.html and
        fast/mediastream/getUserMedia-to-canvas-2.html are failing on
        MacOS when remote video frame flag is enabled"
        https://bugs.webkit.org/show_bug.cgi?id=237042
        https://commits.webkit.org/r290658

2022-03-02  Simon Fraser  <simon.fraser@apple.com>

        Rendering issues with many dynamically-added sticky elements inside overflow scroll
        https://bugs.webkit.org/show_bug.cgi?id=237378
        <rdar://83745510>

        Reviewed by Cameron McCormack.

        * scrollingcoordinator/scrolling-tree/accumulated-unparented-sticky-nodes-expected.txt: Added.
        * scrollingcoordinator/scrolling-tree/accumulated-unparented-sticky-nodes.html: Added.

2022-03-02  Oriol Brufau  <obrufau@igalia.com>

        [css] Implement 'text-decoration' as a shorthand.
        https://bugs.webkit.org/show_bug.cgi?id=237175

        Reviewed by Darin Adler.

        Update tests to take into account that 'text-decoration' is a shorthand.

        * editing/pasteboard/data-transfer-get-data-on-drop-rich-text-expected.txt:
        * fast/css/getComputedStyle/computed-style-expected.txt:
        * fast/css/getComputedStyle/computed-style-without-renderer-expected.txt:
        * fast/css/getComputedStyle/getComputedStyle-text-decoration-expected.txt:
        * fast/css/getComputedStyle/getComputedStyle-text-decoration.html:
        * fast/css/getComputedStyle/resources/property-names.js:
        * fast/css/style-enumerate-properties-expected.txt:
        * fast/css/style-enumerate-properties.html:
        * fast/css3-text/css3-text-decoration/getComputedStyle/getComputedStyle-text-decoration-shorthand-expected.txt:
        * fast/css3-text/css3-text-decoration/getComputedStyle/getComputedStyle-text-decoration-shorthand.html:
        * fast/css3-text/css3-text-decoration/text-decoration-dashed-expected-mismatch.html:
        * fast/css3-text/css3-text-decoration/text-decoration-dashed.html:
        * fast/css3-text/css3-text-decoration/text-decoration-dotted-dashed-expected-mismatch.html:
        * fast/css3-text/css3-text-decoration/text-decoration-dotted-dashed.html:
        * fast/css3-text/css3-text-decoration/text-decoration-dotted-expected-mismatch.html:
        * fast/css3-text/css3-text-decoration/text-decoration-dotted.html:
        * fast/events/input-events-paste-rich-datatransfer-expected.txt:
        * platform/glib/fast/css/getComputedStyle/computed-style-expected.txt: Removed.
        * platform/glib/fast/css/getComputedStyle/computed-style-without-renderer-expected.txt: Removed.
        * platform/glib/svg/css/getComputedStyle-basic-expected.txt: Removed.
        * platform/gtk/fast/events/input-events-paste-rich-datatransfer-expected.txt:
        * platform/gtk/imported/w3c/web-platform-tests/css/css-cascade/all-prop-initial-xml-expected.txt:
        * platform/gtk/imported/w3c/web-platform-tests/css/cssom/getComputedStyle-detached-subtree-expected.txt:
        * platform/ios/fast/css/getComputedStyle/computed-style-expected.txt: Removed.
        * platform/ios/fast/css/getComputedStyle/computed-style-without-renderer-expected.txt: Removed.
        * platform/ios/imported/w3c/web-platform-tests/css/css-cascade/all-prop-initial-xml-expected.txt:
        * platform/ios/imported/w3c/web-platform-tests/css/cssom/getComputedStyle-detached-subtree-expected.txt:
        * platform/ios/svg/css/getComputedStyle-basic-expected.txt: Removed.
        * platform/wpe/imported/w3c/web-platform-tests/css/css-cascade/all-prop-initial-xml-expected.txt:
        * platform/wpe/imported/w3c/web-platform-tests/css/cssom/getComputedStyle-detached-subtree-expected.txt:
        * svg/css/getComputedStyle-basic-expected.txt:

2022-03-02  J Pascoe  <j_pascoe@apple.com>

        [WebAuthn] Remove obsolete failed attestation tests
        https://bugs.webkit.org/show_bug.cgi?id=237346
        rdar://problem/89647260

        Reviewed by Brent Fulgham.

        The removed items tested that creation fails whenever attestation fails, however
        we've changed behavior such that creation succeeds with 'none' attestation in this
        case, making these failure tests obsolete.

        * http/wpt/webauthn/public-key-credential-create-failure-local-silent.https-expected.txt:
        * http/wpt/webauthn/public-key-credential-create-failure-local-silent.https.html:
        * http/wpt/webauthn/public-key-credential-create-failure-local.https-expected.txt:
        * http/wpt/webauthn/public-key-credential-create-failure-local.https.html:

2022-03-02  Matteo Flores  <matteo_flores@apple.com>

        [ iOS Debug ] editing/async-clipboard/* 20 tests are flaky timeouts on iOS.
        https://bugs.webkit.org/show_bug.cgi?id=237372

        Unreviewed test gardening.

        * platform/ios-wk2/TestExpectations:

2022-03-02  Robert Jenner  <Jenner@apple.com>

        REGRESSION(r290539): [ iOS ] 2X http/wpt/webauthn/public-key-credential-create-failure-local (layout-tests) are constant text failures
        https://bugs.webkit.org/show_bug.cgi?id=237346

        Unreviewed test gardening.

        * platform/ios-wk2/TestExpectations:

2022-03-02  Wenson Hsieh  <wenson_hsieh@apple.com>

        [iOS] Copy context menu action should be titled "Copy Link" when long pressing a non-image link
        https://bugs.webkit.org/show_bug.cgi?id=237367
        rdar://77397886

        Reviewed by Devin Rousso.

        Adjust a couple of layout tests to check for items labeled "Copy" (in the case of an image) and "Copy Link" (in
        the case of a link).

        * fast/events/touch/ios/long-press-on-image-expected.txt:
        * fast/events/touch/ios/long-press-on-image.html:
        * fast/events/touch/ios/long-press-on-link-expected.txt:
        * fast/events/touch/ios/long-press-on-link.html:

2022-03-02  Myles C. Maxfield  <mmaxfield@apple.com>

        [Cocoa] The behavior of navigator-language-ru changed in Monterey / iOS 15
        https://bugs.webkit.org/show_bug.cgi?id=237384
        <rdar://problem/80335706>

        Unreviewed test gardening.

        Add a new test for the new behavior, but keep the old one too for older OSes.

        * fast/text/international/system-language/navigator-language/navigator-language-ru-2-expected.txt: Added.
        * fast/text/international/system-language/navigator-language/navigator-language-ru-2.html: Added.
        * platform/ios-14/TestExpectations:
        * platform/ios/TestExpectations:
        * platform/mac-wk2/TestExpectations:

2022-03-02  Antoine Quint  <graouts@webkit.org>

        Outline-width with transition don't animate correctly
        https://bugs.webkit.org/show_bug.cgi?id=173708

        Reviewed by Antti Koivisto.

        Add a repaint test that checks that the outline is accounted for during the transition.

        * fast/repaint/outline-transition-expected.txt: Added.
        * fast/repaint/outline-transition.html: Added.

2022-03-02  Alan Bujtas  <zalan@apple.com>

        [RTL] Image alt text has incorrect bidi reordering
        https://bugs.webkit.org/show_bug.cgi?id=237366
        <rdar://problem/89687229>

        Reviewed by Antti Koivisto.

        * fast/images/alt-text-with-right-to-left-inline-direction-reordering-expected-mismatch.html: Added.
        * fast/images/alt-text-with-right-to-left-inline-direction-reordering.html: Added.

2022-03-02  Oriol Brufau  <obrufau@igalia.com>

        [css-cascade] Support 'revert-layer' in @keyframes
        https://bugs.webkit.org/show_bug.cgi?id=237152

        Reviewed by Antti Koivisto.

        Expect test to pass.

        * TestExpectations:

2022-03-02  Alan Bujtas  <zalan@apple.com>

        [RTL] Incorrect alt text position in right to left context
        https://bugs.webkit.org/show_bug.cgi?id=237352
        <rdar://problem/89657704>

        Reviewed by Simon Fraser.

        * fast/images/alt-text-with-right-to-left-inline-direction-expected-mismatch.html: Added.
        * fast/images/alt-text-with-right-to-left-inline-direction.html: Added.

2022-03-02  Carlos Garcia Campos  <cgarcia@igalia.com>

        REGRESSION(r216096): [GTK] Test accessibility/gtk/menu-list-unfocused-notifications.html is failing since r216096
        https://bugs.webkit.org/show_bug.cgi?id=171598

        Reviewed by Adrian Perez de Castro.

        Since r216096 the notification for menu list changes is deffered, so we need to wait one run loop cycle to get
        the notifications. Also update the test to ignore notifications that are not interesting like AXLoadComplete and
        AXElementBusyChanged, and update expectations for the new behavior with ATSPI where the notification is emitted
        on the menu and not the combo.

        * accessibility/gtk/menu-list-unfocused-notifications-expected.txt:
        * accessibility/gtk/menu-list-unfocused-notifications.html:
        * platform/gtk/TestExpectations:

2022-03-02  Carlos Garcia Campos  <cgarcia@igalia.com>

        [ATSPI] Test accessibility/select-element-at-index.html is failing
        https://bugs.webkit.org/show_bug.cgi?id=237315

        Reviewed by Adrian Perez de Castro.

        This is because the test contains platform specific behavior for ATK that was migrated to ATSPI by mistake. We
        should behave like all other ports now.

        * accessibility/select-element-at-index.html:
        * platform/glib/TestExpectations:

2022-03-01  Devin Rousso  <drousso@apple.com>

        Web Inspector: add a switch to control whether breakpoint evaluations (condition, ignore count, actions) are also affected by script blackboxing
        https://bugs.webkit.org/show_bug.cgi?id=235274

        Reviewed by Patrick Angle.

        * inspector/debugger/setBlackboxBreakpointEvaluations.html: Added.
        * inspector/debugger/setBlackboxBreakpointEvaluations-expected.txt: Added.

2022-03-01  Matteo Flores  <matteo_flores@apple.com>

        [ iOS ] pointerevents/mouse/* 10 pointer event tests are constant timeouts or failures on iOS.
        https://bugs.webkit.org/show_bug.cgi?id=237348

        Unreviewed test gardening.

        * platform/ios-wk2/TestExpectations:

2022-03-01  Jon Lee  <jonlee@apple.com>

        Unreviewed gardening.

        * gpu-process/TestExpectations: r290542 fixed a number of crashing tests.

2022-03-01  Jon Lee  <jonlee@apple.com>

        Unreviewed gardening.

        * gpu-process/TestExpectations:
        * platform/ios/TestExpectations: r290438 fixed a test failure.

2022-03-01  Jon Lee  <jonlee@apple.com>

        Unreviewed gardening.

        * gpu-process/TestExpectations: r290542 fixed a number of crashing tests.

2022-03-01  Alan Bujtas  <zalan@apple.com>

        REGRESSION(r285232) https://alvaromontoro.github.io/almond.css/demo/ looks wrong in Safari, ok in Chrome and Firefox
        https://bugs.webkit.org/show_bug.cgi?id=237276
        <rdar://problem/89566459>

        Reviewed by Simon Fraser.

        * fast/css-grid-layout/ascpect-ratio-with-percent-width-expected.html: Added.
        * fast/css-grid-layout/ascpect-ratio-with-percent-width.html: Added.

2022-03-01  Said Abou-Hallawa  <said@apple.com>

        [macOS][REGRESSION] (rr289518): Form controls are scaled twice on Retina display
        https://bugs.webkit.org/show_bug.cgi?id=237128
        rdar://89064642

        Reviewed by Darin Adler.

        * fast/hidpi/hidpi-form-controls-drawing-size-expected.html: Added.
        * fast/hidpi/hidpi-form-controls-drawing-size.html: Added.

2022-03-01  Robert Jenner  <Jenner@apple.com>

        [ Win ] 4X imported/mozilla/svg/blend(layout-tests) are constant Image Only Failures
        https://bugs.webkit.org/show_bug.cgi?id=237344

        Unreviewed test gardening. Skipping, for Windows instead of adding an expectation.

        * platform/win/TestExpectations:

2022-03-01  Robert Jenner  <Jenner@apple.com>

        [ Win ] 4X imported/mozilla/svg/blend(layout-tests) are constant Image Only Failures
        https://bugs.webkit.org/show_bug.cgi?id=237344

        Unreviewed test gardening.

        * platform/win/TestExpectations:

2022-03-01  Eric Carlson  <eric.carlson@apple.com>

        [Cocoa] HLS stream currentTime sometimes jumps backwards
        https://bugs.webkit.org/show_bug.cgi?id=235087
        rdar://83831093

        Reviewed by Dean Jackson.

        * http/tests/media/hls/hls-non-zero-start-time-expected.txt: Added.
        * http/tests/media/hls/hls-non-zero-start-time.html: Added.
        * http/tests/media/resources/hls/bip-bop-live.m3u8: Added.
        * http/tests/media/resources/hls/bipbop/start-offset.m3u8: Added.
        * http/tests/media/resources/hls/bipbop/start-offset.ts: Added.

2022-03-01  Matt Woodrow  <mattwoodrow@apple.com>

        Use static position relative to parent for abs-pos items within nested grids.
        https://bugs.webkit.org/show_bug.cgi?id=236957

        Reviewed by Dean Jackson.

        * TestExpectations:

       Existing subgrid tests marked as passing.

2022-03-01  Andres Gonzalez  <andresg_22@apple.com>

        Make accessibility/aria-hidden-false-works-in-subtrees.html async to pass in isolated tree mode.
        https://bugs.webkit.org/show_bug.cgi?id=237051
        <rdar://problem/89312156>

        Reviewed by Chris Fleizach.

        * accessibility/aria-hidden-false-works-in-subtrees.html:
        Made both the main script and the iframe onload function async to pass
        in isolated tree mode.

2022-03-01  Matteo Flores  <matteo_flores@apple.com>

        [ Monterey wk2 ] http/tests/media/video-webm-stall.html is a constant text failure
        https://bugs.webkit.org/show_bug.cgi?id=236788

        Unreviewed test gardening.

        * platform/mac-wk2/TestExpectations:

2022-03-01  Matteo Flores  <matteo_flores@apple.com>

        [ Monterey ] webaudio/decode-audio-data-webm-vorbis.html is constantly failing
        https://bugs.webkit.org/show_bug.cgi?id=236328

        Unreviewed test gardening.

        * platform/mac-wk2/TestExpectations:

2022-03-01  Robert Jenner  <Jenner@apple.com>

        WindowServer returned not alive with context:,unresponsive work processor(s)
        <rdar://86037417>

        Unreviewed test gardening.

        * platform/mac-wk2/TestExpectations:

2022-03-01  Youenn Fablet  <youenn@apple.com>

        fast/mediastream/getUserMedia-to-canvas-1.html and fast/mediastream/getUserMedia-to-canvas-2.html are failing on MacOS when remote video frame flag is enabled
        https://bugs.webkit.org/show_bug.cgi?id=237042
        <rdar://problem/89298601>

        Reviewed by Eric Carlson.

        Video element videoWidth/videoHeight are updated when track settings are changed,
        and not when video frames being received.

        This does not guarantee that videoWidth/videoHeight (main thread) are fully in sync
        with the actual video frames (background thread) when there is a change of size.

        We might be able to tighten this in MediaPlayerPrivateMediaStreamAVFObjC by only resorting on video frames.
        In the meantime, we update the test to set the orientation before creating the source.
        This makes sure the video frames have the expected size and rotation.

        * fast/mediastream/getUserMedia-to-canvas-1.html:
        * fast/mediastream/getUserMedia-to-canvas-2.html:
        * fast/mediastream/resources/getUserMedia-to-canvas.js:

2022-03-01  Chris Dumez  <cdumez@apple.com>

        [Debug] imported/w3c/web-platform-tests/url/toascii.window.html is crashing
        https://bugs.webkit.org/show_bug.cgi?id=236442
        <rdar://problem/89085190>

        Unreviewed, unskip test as it no longer appears to crash in Debug.

        * TestExpectations:

2022-03-01  Wenson Hsieh  <wenson_hsieh@apple.com>

        focus({preventScroll: true}) does not prevent scrolling on iOS
        https://bugs.webkit.org/show_bug.cgi?id=236584
        rdar://88911184

        Reviewed by Simon Fraser.

        Add a couple of new layout tests to verify that passing in `{ preventScroll: true }` for focus options causes
        us to avoid scrolling to reveal focused select elements and text fields.

        * fast/forms/select-focus-prevent-scroll-expected.txt: Added.
        * fast/forms/select-focus-prevent-scroll.html: Added.
        * fast/forms/text-field-focus-prevent-scroll-expected.txt: Added.
        * fast/forms/text-field-focus-prevent-scroll.html: Added.
        * resources/ui-helper.js:

        Also make it safe to call `waitForInputSessionToDismiss()` in a platform-agnostic test, by bailing early if
        we're not on iOS, using WebKit2.

2022-03-01  Alan Bujtas  <zalan@apple.com>

        REGRESSION (r273129): Text contents in <span> with opacity not repainting/updating when sibling element has "will-change: transform"
        https://bugs.webkit.org/show_bug.cgi?id=236876
        <rdar://problem/89180092>

        Reviewed by Simon Fraser.

        * fast/repaint/inline-box-with-self-paint-layer-expected.html: Added.
        * fast/repaint/inline-box-with-self-paint-layer.html: Added.

2022-03-01  Kimmo Kinnunen  <kkinnunen@apple.com>

        WebGL GPUP OpenGL context is not used even if WebGL via Metal is deselected
        https://bugs.webkit.org/show_bug.cgi?id=236505

        Reviewed by Myles C. Maxfield.

        * webgl/resources/test-shader-implementation-language.js: Added.
        (runTest):
        * webgl/webgl-via-metal-flag-off-expected.txt: Added.
        * webgl/webgl-via-metal-flag-off.html: Added.
        * webgl/webgl-via-metal-flag-on-expected.txt: Added.
        * webgl/webgl-via-metal-flag-on.html: Added.

2022-03-01  Cameron McCormack  <heycam@apple.com>

        Make input element UA shadow tree creation lazy
        https://bugs.webkit.org/show_bug.cgi?id=236747

        Reviewed by Aditya Keerthi.

        * fast/forms/lazy-shadow-tree-creation-expected.html: Added.
        * fast/forms/lazy-shadow-tree-creation.html: Added.
        * fast/forms/lazy-shadow-tree-creation.js: Added.
        (supportsType):
        (makeAndAppendInput):
        * LayoutTests/fast/forms/lazy-shadow-tree-creation-crash.html:
        * LayoutTests/fast/forms/lazy-shadow-tree-creation-crash-expected.html:
        Crashtest.
        * fast/shadow-dom/style-resolver-sharing-expected.txt:
        Update to account for the lazy shadow tree being created later.

2022-03-01  Arcady Goldmints-Orlov  <agoldmints@igalia.com>

        [GLIB] Update test expectations and baselines. Unreviewed test gardening.
        https://bugs.webkit.org/show_bug.cgi?id=237310

        * platform/glib/css3/flexbox/line-wrapping-expected.txt:
        * platform/glib/fast/block/positioning/auto/vertical-lr/007-expected.txt:
        * platform/glib/fast/dom/scroll-reveal-top-overflow-expected.txt: Added.
        * platform/glib/tables/mozilla_expected_failures/dom/appendColGroup1-expected.txt:
        * platform/gtk/TestExpectations:
        * platform/gtk/fast/repaint/vertical-text-repaint-expected.txt: Added.
        * platform/gtk/fast/writing-mode/japanese-lr-selection-expected.txt:
        * platform/gtk/tables/mozilla_expected_failures/dom/appendCol1-expected.txt:
        * platform/wpe/fast/repaint/vertical-text-repaint-expected.txt: Added.
        * platform/wpe/fast/writing-mode/japanese-lr-selection-expected.txt:
        * platform/wpe/tables/mozilla_expected_failures/dom/appendCol1-expected.txt:

2022-03-01  Matt Woodrow  <mattwoodrow@apple.com>

        Handle perpendicular containing blocks when computing available logical height.
        https://bugs.webkit.org/show_bug.cgi?id=236953

        Reviewed by Dean Jackson.

        * TestExpectations:

        Existing subgrid tests marked as passing.

2022-03-01  Carlos Garcia Campos  <cgarcia@igalia.com>

        [ATSPI] Remove layout tests checking children added/removed notifications
        https://bugs.webkit.org/show_bug.cgi?id=237272

        Reviewed by Adrian Perez de Castro.

        Children changed notifications are not expected by any other tests because other ports don't support them. We
        already have unit tests to ensure they work as expected so we can just remove the layout tests and ensure we
        don't emit those notifications either.

        * accessibility/children-changed-sends-notification-expected.txt: Removed.
        * accessibility/children-changed-sends-notification.html: Removed.
        * accessibility/gtk/menu-list-unfocused-notifications-expected.txt:
        * accessibility/gtk/no-notification-for-unrendered-iframe-children-expected.txt: Removed.
        * accessibility/gtk/no-notification-for-unrendered-iframe-children.html: Removed.
        * platform/glib/TestExpectations:
        * platform/gtk/TestExpectations:
        * platform/mac/TestExpectations:
        * platform/win/TestExpectations:
        * platform/wincairo-wk1/TestExpectations:

2022-02-28  Tyler Wilcock  <tyler_w@apple.com>

        AX: WebKit should ignore empty modals rather than trapping focus inside them
        https://bugs.webkit.org/show_bug.cgi?id=237163

        Reviewed by Chris Fleizach and Andres Gonzalez.

        * accessibility/ignore-modals-without-any-content-expected.txt: Added.
        * accessibility/ignore-modals-without-any-content.html: Added.
        * platform/glib/TestExpectations: Skip new test.
        * platform/ios/TestExpectations: Enable new test.
        * platform/ios/accessibility/ignore-modals-without-any-content-expected.txt: Added.
        * platform/win/TestExpectations: Skip new test.

2022-02-28  Simon Fraser  <simon.fraser@apple.com>

        Compositing/paint invalidation with transforms
        https://bugs.webkit.org/show_bug.cgi?id=233421
        <rdar://problem/85814854>

        Reviewed by Alan Bujtas.
        
        * compositing/repaint/composite-and-scale-change-expected.txt: Added.
        * compositing/repaint/composite-and-scale-change.html: Added.
            Test that dumps repaint rects.
        * compositing/shared-backing/repaint-into-shared-backing-become-composited-expected.html: Added.
        * compositing/shared-backing/repaint-into-shared-backing-become-composited.html: Added.
            Companion to repaint-into-shared-backing.html but toggles compositing in the other
            direction.
        * platform/gtk/compositing/repaint/composite-and-scale-change-actual.txt: Added.
        * platform/mac-wk1/compositing/repaint/composite-and-scale-change-expected.txt: Added.

2022-02-28  Simon Fraser  <simon.fraser@apple.com>

        No animation when scroll snap scroller is navigated with the keyboard
        https://bugs.webkit.org/show_bug.cgi?id=236244

        Reviewed by Tim Horton.

        Turn off the scroll animator for these tests that assume that scrolling is instantaneous.

        * css3/scroll-snap/scroll-padding-overflow-paging.html:
        * fast/events/wheelevent-in-scrolling-div.html:
        * tiled-drawing/scrolling/scroll-snap/scroll-snap-proximity-overflow-rtl-with-keyboard.html:

2022-02-28  Matteo Flores  <matteo_flores@apple.com>

        [ iOS ] fast/mediastream/video-rotation-gpu-process-crash.html is a flaky crash
        https://bugs.webkit.org/show_bug.cgi?id=237295

        Unreviewed test gardening.

        * platform/ios/TestExpectations:

2022-02-28  Robert Jenner  <Jenner@apple.com>

        REBASELINE [ iOS15 ] fast/text/khmer-lao-font.html is a constant text failure
        <rdar://88841324>

        Unreviewed test gardening. Rebaseline for iOS15.

        * platform/ios-wk2/TestExpectations:
        * platform/ios-wk2/fast/text/khmer-lao-font-expected.txt:
        * platform/ios/fast/text/khmer-lao-font-expected.txt:

2022-02-28  Rob Buis  <rbuis@igalia.com>

        Handle widow relayout differently
        https://bugs.webkit.org/show_bug.cgi?id=235519

        Reviewed by Alan Bujtas.

        * fast/multicol/widow-many-relayouts-crash-expected.txt: Added.
        * fast/multicol/widow-many-relayouts-crash.html: Added.

2022-02-28  Devin Rousso  <drousso@apple.com>

        Web Inspector: add `IterableWeakSet`
        https://bugs.webkit.org/show_bug.cgi?id=237141

        Reviewed by Patrick Angle.

        * inspector/unit-tests/iterableweakset.html: Added.
        * inspector/unit-tests/iterableweakset-expected.txt: Added.

2022-02-28  Matteo Flores  <matteo_flores@apple.com>

        REGRESSION(r288070): [ Monterey ] platform/mac/fast/text/international/Geeza-Pro-vertical-metrics-adjustment.html is a constant text failure.
        https://bugs.webkit.org/show_bug.cgi?id=236857

        Unreviewed test gardening.

        * platform/mac/fast/text/international/Geeza-Pro-vertical-metrics-adjustment-expected.txt: Removed.
        * platform/mac/platform/mac/fast/text/international/Geeza-Pro-vertical-metrics-adjustment-expected.txt: Previous file was in platform/mac/fast... instead of platform/mac/platform/mac/fast...

2022-02-28  Aditya Keerthi  <akeerthi@apple.com>

        [macOS] Unable to upload ".pages" files to file inputs accepting ".pages" and ".jpeg" files
        https://bugs.webkit.org/show_bug.cgi?id=237219
        rdar://89482882

        Reviewed by Tim Horton and Said Abou-Hallawa.

        Add a layout test that contains a file input that accepts ".pages" and
        ".jpeg" files, and attempts to upload a ".pages" file.

        * TestExpectations:
        * fast/forms/file/entries-api/pages-jpeg-open-panel-expected.txt: Added.
        * fast/forms/file/entries-api/pages-jpeg-open-panel.html: Added.
        * fast/forms/file/entries-api/pdf-jpeg-open-panel-expected.txt: Added.
        * fast/forms/file/entries-api/pdf-jpeg-open-panel.html: Added.
        * fast/forms/file/entries-api/resources/documents/document.pages: Added.
        * fast/forms/file/entries-api/resources/documents/document.pdf: Added.
        * platform/mac-wk2/TestExpectations:

2022-02-28  Simon Fraser  <simon.fraser@apple.com>

        Revert r290548
        
        It caused three tests to start failing.

        * css3/scroll-snap/scroll-padding-overflow-paging.html:
        * fast/events/wheelevent-in-scrolling-div.html:
        * tiled-drawing/scrolling/scroll-snap/scroll-snap-proximity-overflow-rtl-with-keyboard.html:

2022-02-28  Pascal Abresch  <nep@packageloss.eu>

        FTP EPLF does not handle directory
        https://bugs.webkit.org/show_bug.cgi?id=45113

        Reviewed by Darin Adler.

        The code used "!result.type" to check for an invalid type. However,
        the first type in the FTPEntryType enum is FTPDirectoryEntry, so this
        was actually returning true for directories, turning them into "junk"
        entries which would not be listed.

        Since the code for EPLF can only result in either files, directories,
        or uninitialized/junk entries, the check can be removed, returning
        result.type is the correct thing to do in all 3 cases.
    
        * http/tests/misc/ftp-eplf-directory-expected.txt: Added.
        * http/tests/misc/ftp-eplf-directory.py: Added.
        * platform/gtk/TestExpectations:

2022-02-28  Carlos Garcia Campos  <cgarcia@igalia.com>

        [ATSPI] Always expose table cells (layout and CSS) that have rendered text content
        https://bugs.webkit.org/show_bug.cgi?id=237204

        Reviewed by Adrian Perez de Castro.

        * accessibility/gtk/nested-block-element-children-expected.txt: Rebaseline.
        * platform/glib/TestExpectations: Remove accessibility/generated-content-with-display-table-crash.html.
        * platform/gtk/TestExpectations: Remove accessibility/gtk/nested-block-element-children.html.

2022-02-28  Carlos Garcia Campos  <cgarcia@igalia.com>

        [GTK][a11y] Test accessibility/gtk/xml-roles-exposed.html is failing since ATSPI switch
        https://bugs.webkit.org/show_bug.cgi?id=237202

        Reviewed by Adrian Perez de Castro.

        * platform/gtk/TestExpectations: Remove accessibility/gtk/xml-roles-exposed.html.
        * platform/gtk/accessibility/gtk/xml-roles-exposed-expected.txt: Rebaseline.

2022-02-27  Jonathan Bedard  <jbedard@apple.com>

        webkitpy: WebSocket server doesn't support Python 3
        https://bugs.webkit.org/show_bug.cgi?id=230319
        <rdar://problem/58814743>

        Reviewed by Fujii Hironori.

        Make all tests Python 3 compatible, even at the cost of Python 2
        compatibility, since WebSocket tests are always invoked with Python 3.

        * TestExpectations:
        * http/tests/websocket/tests/hybi/bad-handshake-crash_wsh.py:
        (web_socket_do_extra_handshake):
        * http/tests/websocket/tests/hybi/binary-frames_wsh.py:
        (web_socket_transfer_data):
        (all_distinct_bytes):
        * http/tests/websocket/tests/hybi/broken-utf8_wsh.py:
        (web_socket_transfer_data):
        * http/tests/websocket/tests/hybi/check-binary-messages_wsh.py:
        (web_socket_transfer_data):
        (all_distinct_bytes):
        * http/tests/websocket/tests/hybi/client-close-2-expected.txt:
        * http/tests/websocket/tests/hybi/client-close-2.html:
        * http/tests/websocket/tests/hybi/client-close-2_wsh.py:
        (web_socket_transfer_data):
        * http/tests/websocket/tests/hybi/client-close-expected.txt:
        * http/tests/websocket/tests/hybi/client-close.html:
        * http/tests/websocket/tests/hybi/client-close_wsh.py:
        (web_socket_transfer_data):
        * http/tests/websocket/tests/hybi/close-code-and-reason_wsh.py:
        (web_socket_transfer_data):
        * http/tests/websocket/tests/hybi/close-on-unload_wsh.py:
        (web_socket_transfer_data):
        * http/tests/websocket/tests/hybi/compressed-control-frame_wsh.py:
        (web_socket_transfer_data):
        * http/tests/websocket/tests/hybi/cookie_wsh.py:
        (web_socket_do_extra_handshake):
        * http/tests/websocket/tests/hybi/deflate-frame-invalid-parameter_wsh.py:
        (web_socket_do_extra_handshake):
        * http/tests/websocket/tests/hybi/deflate-frame_wsh.py:
        (_get_deflate_frame_extension_processor):
        (web_socket_do_extra_handshake):
        (web_socket_transfer_data):
        * http/tests/websocket/tests/hybi/echo-cookie_wsh.py:
        (web_socket_transfer_data):
        * http/tests/websocket/tests/hybi/echo_wsh.py:
        (web_socket_transfer_data):
        * http/tests/websocket/tests/hybi/fragmented-binary-frames_wsh.py:
        (web_socket_transfer_data):
        * http/tests/websocket/tests/hybi/handshake-fail-by-extensions-header_wsh.py:
        (web_socket_do_extra_handshake):
        * http/tests/websocket/tests/hybi/handshake-fail-by-invalid-http-version_wsh.py:
        (web_socket_do_extra_handshake):
        * http/tests/websocket/tests/hybi/handshake-fail-by-maxlength_wsh.py:
        (web_socket_do_extra_handshake):
        * http/tests/websocket/tests/hybi/handshake-fail-by-mismatch-protocol-header_wsh.py:
        (web_socket_do_extra_handshake):
        * http/tests/websocket/tests/hybi/handshake-fail-by-more-accept-header_wsh.py:
        (web_socket_do_extra_handshake):
        * http/tests/websocket/tests/hybi/handshake-fail-by-more-extensions-header_wsh.py:
        (web_socket_do_extra_handshake):
        * http/tests/websocket/tests/hybi/handshake-fail-by-more-protocol-header_wsh.py:
        (web_socket_do_extra_handshake):
        * http/tests/websocket/tests/hybi/handshake-fail-by-no-accept-header_wsh.py:
        (web_socket_do_extra_handshake):
        * http/tests/websocket/tests/hybi/handshake-fail-by-no-connection-header_wsh.py:
        (web_socket_do_extra_handshake):
        * http/tests/websocket/tests/hybi/handshake-fail-by-no-cr_wsh.py:
        (web_socket_do_extra_handshake):
        * http/tests/websocket/tests/hybi/handshake-fail-by-no-upgrade-header_wsh.py:
        (web_socket_do_extra_handshake):
        * http/tests/websocket/tests/hybi/handshake-fail-by-non-ascii-header-value-sec-websocket-accept_wsh.py:
        (web_socket_do_extra_handshake):
        * http/tests/websocket/tests/hybi/handshake-fail-by-non-ascii-header-value-sec-websocket-extensions_wsh.py:
        (web_socket_do_extra_handshake):
        * http/tests/websocket/tests/hybi/handshake-fail-by-non-ascii-header-value-sec-websocket-protocol_wsh.py:
        (web_socket_do_extra_handshake):
        * http/tests/websocket/tests/hybi/handshake-fail-by-non-ascii-status-line_wsh.py:
        (web_socket_do_extra_handshake):
        * http/tests/websocket/tests/hybi/handshake-fail-by-null-char-in-status_wsh.py:
        (web_socket_do_extra_handshake):
        * http/tests/websocket/tests/hybi/handshake-fail-by-prepended-null_wsh.py:
        (web_socket_do_extra_handshake):
        * http/tests/websocket/tests/hybi/handshake-fail-by-wrong-accept-header_wsh.py:
        (web_socket_do_extra_handshake):
        * http/tests/websocket/tests/hybi/handshake-ok-with-http-version-beyond-1_1_wsh.py:
        (web_socket_do_extra_handshake):
        * http/tests/websocket/tests/hybi/handshake-ok-with-legacy-sec-websocket-response-headers_wsh.py:
        (web_socket_do_extra_handshake):
        * http/tests/websocket/tests/hybi/handshake-ok-with-legacy-websocket-response-headers_wsh.py:
        (web_socket_do_extra_handshake):
        * http/tests/websocket/tests/hybi/imported/blink/permessage-deflate-invalid-parameter_wsh.py:
        (web_socket_do_extra_handshake):
        * http/tests/websocket/tests/hybi/imported/blink/permessage-deflate-manual_wsh.py:
        * http/tests/websocket/tests/hybi/imported/blink/permessage-deflate-unsolicited-negotiation-response_wsh.py:
        * http/tests/websocket/tests/hybi/imported/blink/permessage-deflate_wsh.py:
        (web_socket_transfer_data):
        * http/tests/websocket/tests/hybi/inspector/binary_wsh.py:
        (web_socket_transfer_data):
        (all_distinct_bytes):
        * http/tests/websocket/tests/hybi/invalid-continuation_wsh.py:
        (web_socket_transfer_data):
        * http/tests/websocket/tests/hybi/invalid-encode-length_wsh.py:
        (web_socket_transfer_data):
        * http/tests/websocket/tests/hybi/pong_wsh.py:
        (web_socket_transfer_data):
        * http/tests/websocket/tests/hybi/protocol-test_wsh.py:
        (web_socket_do_extra_handshake):
        * http/tests/websocket/tests/hybi/reserved-bits_wsh.py:
        (_get_deflate_frame_extension_processor):
        (web_socket_transfer_data):
        * http/tests/websocket/tests/hybi/reserved-opcodes_wsh.py:
        (web_socket_transfer_data):
        * http/tests/websocket/tests/hybi/send-file-blob_wsh.py:
        (web_socket_transfer_data):
        (all_distinct_bytes):
        * http/tests/websocket/tests/hybi/too-long-payload_wsh.py:
        (web_socket_transfer_data):
        * http/tests/websocket/tests/hybi/unicode_wsh.py:
        * http/tests/websocket/tests/hybi/unmasked-frames_wsh.py:
        (web_socket_transfer_data):
        * http/tests/websocket/tests/hybi/workers/resources/binary-frames_wsh.py:
        (web_socket_transfer_data):
        (all_distinct_bytes):
        * http/tests/websocket/tests/hybi/workers/resources/check-binary-messages_wsh.py:
        (web_socket_transfer_data):
        (all_distinct_bytes):
        * http/tests/websocket/tests/hybi/workers/resources/no-onmessage-in-sync-op_wsh.py:
        (web_socket_transfer_data):
        * http/tests/websocket/tests/hybi/workers/resources/protocol-test_wsh.py:
        (web_socket_do_extra_handshake):
        * http/tests/websocket/tests/hybi/zero-length-text_wsh.py:
        (web_socket_transfer_data):
        * platform/glib/TestExpectations:
        * platform/ios-wk2/http/tests/websocket/tests/hybi/handshake-fail-by-no-cr-expected.txt:
        * platform/mac-wk2/http/tests/websocket/tests/hybi/client-close-2-expected.txt: Removed.
        * platform/mac-wk2/http/tests/websocket/tests/hybi/client-close-expected.txt: Removed.
        * platform/mac-wk2/http/tests/websocket/tests/hybi/handshake-fail-by-no-cr-expected.txt:
        * platform/mac/TestExpectations:
        * platform/win/TestExpectations:
        * platform/wincairo/TestExpectations:

2022-02-27  Commit Queue  <commit-queue@webkit.org>

        Unreviewed, reverting r290577.
        https://bugs.webkit.org/show_bug.cgi?id=237264

        Breaks ios-wk2 layout test.

        Reverted changeset:

        "Compute correct containing block override size for items that
        are subgridden in one dimension only."
        https://bugs.webkit.org/show_bug.cgi?id=236951
        https://commits.webkit.org/r290577

2022-02-27  Matt Woodrow  <mattwoodrow@apple.com>

        Compute correct containing block override size for items that are subgridden in one dimension only.
        https://bugs.webkit.org/show_bug.cgi?id=236951

        Reviewed by Dean Jackson.

        * TestExpectations:

        Marked existing WPT as passing.

2022-02-27  Matt Woodrow  <mattwoodrow@apple.com>

        Convert grid direction to be relative to subgrid when accounting for extra margin.
        https://bugs.webkit.org/show_bug.cgi?id=236954

        Reviewed by Dean Jackson.

        * TestExpectations:

        Marks existing test orthogonal-writing-mode-003.html as passing.

2022-02-27  Matt Woodrow  <mattwoodrow@apple.com>

        Handle reverse flow direction when converting iterator coords for a subgrid
        https://bugs.webkit.org/show_bug.cgi?id=236955

        Reviewed by Dean Jackson.

        * TestExpectations:

        Marked grid-gap-007.html as now passing, and added bug annotations to
        remaining subgrid failures.

2022-02-27  Philippe Normand  <pnormand@igalia.com>

        [GStreamer] media/video-src-blob-perf.html timing out likely since update to GStreamer 1.20
        https://bugs.webkit.org/show_bug.cgi?id=237256

        Unreviewed, gardening

        * platform/glib/TestExpectations: Flag test as timing out.

2022-02-27  Tim Nguyen  <ntim@apple.com>

        Optimize StyleSharingResolver inert checks
        https://bugs.webkit.org/show_bug.cgi?id=237235

        Reviewed by Youenn Fablet.

        Add small test that style sharing is not wrongly applied.

        * fast/css/inert-style-sharing-expected.html: Added.
        * fast/css/inert-style-sharing.html: Added.

2022-02-27  Tim Nguyen  <ntim@apple.com>

        Re-import inert and <dialog> WPT
        https://bugs.webkit.org/show_bug.cgi?id=237243

        Reviewed by Youenn Fablet.

        Upstream commit: https://github.com/web-platform-tests/wpt/commit/9261ca87db106c1f31f1ab4f54b8f4a2617cbc24

        * TestExpectations:
        * platform/ios-wk2/imported/w3c/web-platform-tests/inert/inert-iframe-hittest.tentative-expected.txt:
        * platform/ios-wk2/imported/w3c/web-platform-tests/inert/inert-iframe-tabbing.tentative-expected.txt:

2022-02-26  Tim Nguyen  <ntim@apple.com>

        Remove Node::deprecatedIsInert
        https://bugs.webkit.org/show_bug.cgi?id=230845

        Reviewed by Antti Koivisto.

        * platform/ios-wk2/imported/w3c/web-platform-tests/html/semantics/interactive-elements/the-dialog-element/dialog-focusing-steps-inert-expected.txt: Added.
        * platform/ios-wk2/imported/w3c/web-platform-tests/html/semantics/interactive-elements/the-dialog-element/dialog-showModal-expected.txt: Added.

2022-02-26  Kate Cheney  <katherine_cheney@apple.com>

        Update CSP handling of javascript URLs
        https://bugs.webkit.org/show_bug.cgi?id=236351
        <rdar://problem/88675827>

        Reviewed by Brent Fulgham.

        * TestExpectations:
        * http/tests/security/contentSecurityPolicy/inline-script-blocked-javascript-url-expected.txt:
        * http/tests/security/contentSecurityPolicy/javascript-url-blocked-by-default-src-star-expected.txt:
        * http/tests/security/contentSecurityPolicy/javascript-url-blocked-expected.txt:

2022-02-26  Alan Bujtas  <zalan@apple.com>

        [RenderTreeBuilder] Clean up descendant floats when a block container becomes float
        https://bugs.webkit.org/show_bug.cgi?id=237238
        <rdar://79960422>

        Reviewed by Antti Koivisto.

        * fast/block/float/float-merge-anon-parent-crash-expected.txt: Added.
        * fast/block/float/float-merge-anon-parent-crash.html: Added.

2022-02-26  Simon Fraser  <simon.fraser@apple.com>

        No animation when scroll snap scroller is navigated with the keyboard
        https://bugs.webkit.org/show_bug.cgi?id=236244

        Reviewed by Tim Horton.

        Turn off the scroll animator for these tests that assume that scrolling is instantaneous.

        * css3/scroll-snap/scroll-padding-overflow-paging.html:
        * fast/events/wheelevent-in-scrolling-div.html:
        * tiled-drawing/scrolling/scroll-snap/scroll-snap-proximity-overflow-rtl-with-keyboard.html:

2022-02-26  Youenn Fablet  <youenn@apple.com>

        REGRESSION(r290358): [ Debug EWS ] ASSERTION FAILED: sample && sample->pixelBuffer()
        https://bugs.webkit.org/show_bug.cgi?id=237164
        <rdar://problem/89442999>

        Unreviewed.

        ASSERTS are fixed through https://bugs.webkit.org/show_bug.cgi?id=237027.
        Removing crash expectations.

        * platform/ios/TestExpectations:
        * platform/mac/TestExpectations:

2022-02-25  Simon Fraser  <simon.fraser@apple.com>

        Scrollbars disappear when very long or wide
        https://bugs.webkit.org/show_bug.cgi?id=237232

        Reviewed by Tim Horton.

        * fast/scrolling/mac/scrollbars/very-wide-overlay-scrollbar-expected-mismatch.html: Added.
        * fast/scrolling/mac/scrollbars/very-wide-overlay-scrollbar.html: Added.

2022-02-25  Chris Dumez  <cdumez@apple.com>

        SharedArrayBuffer posted to AudioWorkletProcessor is not actually shared with the main thread
        https://bugs.webkit.org/show_bug.cgi?id=237144
        <rdar://problem/89479641>

        Reviewed by Darin Adler.

        Add layout test coverage.

        * http/wpt/webaudio/the-audio-api/the-audioworklet-interface/processors/shared-array-buffer-processor.js: Added.
        (SharedArrayBufferTestProcessor):
        (SharedArrayBufferTestProcessor.prototype.process):
        * http/wpt/webaudio/the-audio-api/the-audioworklet-interface/shared-array-buffer.https-expected.txt: Added.
        * http/wpt/webaudio/the-audio-api/the-audioworklet-interface/shared-array-buffer.https.html: Added.
        * http/wpt/webaudio/the-audio-api/the-audioworklet-interface/shared-array-buffer.https.html.headers: Added.

2022-02-25  Robert Jenner  <Jenner@apple.com>

        [ Mac wk1 ] 7X imported/w3c/web-platform-tests/pointerevents/pointerevent (layout-tests) are flaky text failures
        https://bugs.webkit.org/show_bug.cgi?id=236128

        
        Unreviewed test gardening.

        * platform/mac-wk1/TestExpectations:

2022-02-25  Matteo Flores  <matteo_flores@apple.com>

        [ iOS EWS ] imported/w3c/web-platform-tests/svg/coordinate-systems/abspos.html is a flaky image failure.
        https://bugs.webkit.org/show_bug.cgi?id=237220

        Unreviewed test gardening.

        * platform/ios/TestExpectations:

2022-02-25  Matteo Flores  <matteo_flores@apple.com>

        REGRESSION(r289787?) [ iOS EWS ]fast/layers/parent-clipping-overflow-is-overwritten-by-child-clipping.html is a flaky image failure.
        https://bugs.webkit.org/show_bug.cgi?id=237218

        Unreviewed test gardening.

        * platform/ios/TestExpectations:

2022-02-25  Alex Christensen  <achristensen@webkit.org>

        Re-add YouTubePluginReplacement, removed in r285252
        https://bugs.webkit.org/show_bug.cgi?id=237182

        Reviewed by Chris Dumez.

        * TestExpectations:
        * platform/ios-wk2/TestExpectations:
        * platform/win/TestExpectations:
        * security/contentSecurityPolicy/object-src-none-blocks-youtube-plugin-replacement-expected.txt: Copied from LayoutTests/security/contentSecurityPolicy/object-src-none-blocks-youtube-plugin-replacement-expected.txt.
        * security/contentSecurityPolicy/object-src-none-blocks-youtube-plugin-replacement.html: Copied from LayoutTests/security/contentSecurityPolicy/object-src-none-blocks-youtube-plugin-replacement.html.
        * security/contentSecurityPolicy/plugins-types-allows-youtube-plugin-replacement-expected.txt: Copied from LayoutTests/security/contentSecurityPolicy/plugins-types-allows-youtube-plugin-replacement-expected.txt.
        * security/contentSecurityPolicy/plugins-types-allows-youtube-plugin-replacement.html: Copied from LayoutTests/security/contentSecurityPolicy/plugins-types-allows-youtube-plugin-replacement.html.
        * security/contentSecurityPolicy/plugins-types-blocks-youtube-plugin-replacement-expected.txt: Copied from LayoutTests/security/contentSecurityPolicy/plugins-types-blocks-youtube-plugin-replacement-expected.txt.
        * security/contentSecurityPolicy/plugins-types-blocks-youtube-plugin-replacement-without-mime-type-expected.txt: Copied from LayoutTests/security/contentSecurityPolicy/plugins-types-blocks-youtube-plugin-replacement-without-mime-type-expected.txt.
        * security/contentSecurityPolicy/plugins-types-blocks-youtube-plugin-replacement-without-mime-type.html: Copied from LayoutTests/security/contentSecurityPolicy/plugins-types-blocks-youtube-plugin-replacement-without-mime-type.html.
        * security/contentSecurityPolicy/plugins-types-blocks-youtube-plugin-replacement.html: Copied from LayoutTests/security/contentSecurityPolicy/plugins-types-blocks-youtube-plugin-replacement.html.

2022-02-25  J Pascoe  <j_pascoe@apple.com>

        [WebAuthn] Use default pubKeyCredParams if empty in makeCredential
        https://bugs.webkit.org/show_bug.cgi?id=237109
        rdar://problem/89376484

        Reviewed by Brent Fulgham.

        Update tests to take in account using default pubKeyCredParams.

        * http/wpt/webauthn/public-key-credential-create-failure.https-expected.txt:
        * http/wpt/webauthn/public-key-credential-create-failure.https.html:
        * http/wpt/webauthn/public-key-credential-create-success-hid.https-expected.txt:
        * http/wpt/webauthn/public-key-credential-create-success-hid.https.html:

2022-02-25  Alan Bujtas  <zalan@apple.com>

        [Tables] Incorrect table sizing when colgroup comes after tbody
        https://bugs.webkit.org/show_bug.cgi?id=237205
        <rdar://86582214>

        Reviewed by Antti Koivisto.

        * fast/table/table-sizing-fails-when-colgroup-comes-after-content-expected.html: Added.
        * fast/table/table-sizing-fails-when-colgroup-comes-after-content.html: Added.
        * platform/mac/tables/mozilla_expected_failures/dom/appendCol1-expected.txt: Progression.
        * platform/mac/tables/mozilla_expected_failures/dom/appendColGroup1-expected.txt: Progression.

2022-02-25  Youenn Fablet  <youenn@apple.com>

        Non-simple CORS preflight fails due to cache-control header
        https://bugs.webkit.org/show_bug.cgi?id=236837
        <rdar://problem/89382796>

        Reviewed by Chris Dumez.

        * http/wpt/service-workers/cache-control-request-expected.txt:
        * http/wpt/service-workers/cache-control-request.html:
        * http/wpt/service-workers/resources/cross-origin-allow-for-beacon.py: Added.

2022-02-25  Kimmo Kinnunen  <kkinnunen@apple.com>

        REGRESSION(r289580): [ iOS macOS ] TestWebKitAPI.IPCTestingAPI.CanReceiveSharedMemory is a constant timeout
        https://bugs.webkit.org/show_bug.cgi?id=236744

        Reviewed by Antti Koivisto.

        * ipc/stream-sync-reply-shared-memory-expected.txt: Added.
        * ipc/stream-sync-reply-shared-memory.html: Added.

2022-02-25  Carlos Garcia Campos  <cgarcia@igalia.com>

        AX: List item marker not exposed when not a direct child of a list item
        https://bugs.webkit.org/show_bug.cgi?id=236777
        <rdar://problem/89082485>

        Reviewed by Adrian Perez de Castro.

        Update test results.

        * accessibility/gtk/list-items-always-exposed-expected.txt:
        * accessibility/gtk/list-items-always-exposed.html:
        * accessibility/gtk/spans-expected.txt:
        * accessibility/gtk/spans.html:
        * platform/gtk/TestExpectations:

2022-02-25  Arcady Goldmints-Orlov  <agoldmints@igalia.com>

        [GLIB] Update test baselines after various LFC improvements.
        https://bugs.webkit.org/show_bug.cgi?id=237184

        Unreviewed test gardening.

        * platform/glib/fast/backgrounds/background-leakage-transforms-expected.txt:
        * platform/glib/fast/backgrounds/border-radius-split-background-expected.txt:
        * platform/glib/fast/backgrounds/border-radius-split-background-image-expected.txt:
        * platform/glib/fast/block/positioning/auto/vertical-lr/001-expected.txt:
        * platform/glib/fast/block/positioning/auto/vertical-lr/002-expected.txt:
        * platform/glib/fast/block/positioning/auto/vertical-lr/003-expected.txt:
        * platform/glib/fast/block/positioning/auto/vertical-lr/004-expected.txt:
        * platform/glib/fast/block/positioning/auto/vertical-lr/006-expected.txt:
        * platform/glib/fast/block/positioning/vertical-lr/002-expected.txt:
        * platform/glib/fast/borders/border-image-outset-split-inline-vertical-lr-expected.txt:
        * platform/glib/fast/replaced/vertical-lr/absolute-position-percentage-width-expected.txt:
        * platform/glib/fast/replaced/vertical-lr/absolute-position-with-auto-height-and-top-and-bottom-expected.txt:
        * platform/glib/fast/replaced/vertical-lr/absolute-position-with-auto-width-and-left-and-right-expected.txt:
        * platform/glib/fast/table/border-collapsing/002-vertical-expected.txt:
        * platform/glib/fast/writing-mode/basic-vertical-line-expected.txt:
        * platform/glib/fast/writing-mode/border-image-vertical-lr-expected.txt:
        * platform/glib/fast/writing-mode/border-radius-clipping-vertical-lr-expected.txt:
        * platform/glib/fast/writing-mode/border-styles-vertical-lr-expected.txt:
        * platform/glib/fast/writing-mode/border-styles-vertical-lr-mixed-expected.txt:
        * platform/glib/fast/writing-mode/border-styles-vertical-rl-expected.txt:
        * platform/glib/fast/writing-mode/border-styles-vertical-rl-mixed-expected.txt:
        * platform/glib/fast/writing-mode/border-vertical-lr-expected.txt:
        * platform/glib/fast/writing-mode/box-shadow-vertical-lr-expected.txt:
        * platform/glib/fast/writing-mode/japanese-lr-text-expected.txt:
        * platform/glib/imported/w3c/web-platform-tests/css/cssom-view/offsetTopLeft-empty-inline-expected.txt: Added.
        * platform/glib/imported/w3c/web-platform-tests/css/cssom-view/offsetTopLeft-leading-space-inline-expected.txt: Added.
        * platform/gtk/fast/block/lineboxcontain/inline-box-vertical-expected.txt:
        * platform/gtk/fast/html/details-writing-mode-expected.txt:
        * platform/gtk/fast/html/details-writing-mode-mixed-expected.txt:
        * platform/gtk/fast/lists/003-vertical-expected.txt:
        * platform/gtk/fast/overflow/overflow-rtl-vertical-expected.txt:
        * platform/gtk/fast/text/international/synthesized-italic-vertical-latin-expected.txt:
        * platform/gtk/fast/writing-mode/english-lr-text-expected.txt:
        * platform/gtk/fast/writing-mode/text-orientation-basic-expected.txt:
        * platform/gtk/fast/writing-mode/vertical-lr-replaced-selection-expected.txt:
        * platform/gtk/imported/w3c/web-platform-tests/css/cssom-view/offsetTopLeft-empty-inline-expected.txt: Removed.
        * platform/gtk/imported/w3c/web-platform-tests/css/cssom-view/offsetTopLeft-leading-space-inline-expected.txt: Removed.
        * platform/wpe/fast/block/lineboxcontain/inline-box-vertical-expected.txt:
        * platform/wpe/fast/html/details-writing-mode-expected.txt:
        * platform/wpe/fast/html/details-writing-mode-mixed-expected.txt:
        * platform/wpe/fast/lists/003-vertical-expected.txt:
        * platform/wpe/fast/overflow/overflow-rtl-vertical-expected.txt:
        * platform/wpe/fast/text/international/synthesized-italic-vertical-latin-expected.txt:
        * platform/wpe/fast/writing-mode/english-lr-text-expected.txt:
        * platform/wpe/fast/writing-mode/text-orientation-basic-expected.txt:
        * platform/wpe/fast/writing-mode/vertical-lr-replaced-selection-expected.txt:
        * platform/wpe/imported/w3c/web-platform-tests/css/cssom-view/offsetTopLeft-empty-inline-expected.txt: Removed.
        * platform/wpe/imported/w3c/web-platform-tests/css/cssom-view/offsetTopLeft-leading-space-inline-expected.txt: Removed.

2022-02-24  Alan Bujtas  <zalan@apple.com>

        Unreviewed test gardening after r290454.

        * TestExpectations: Progressions.

2022-02-24  Matteo Flores  <matteo_flores@apple.com>

        [ iOS ] editing/pasteboard/dom-paste/dom-paste-same-origin.html is a flaky timeout/failure
        https://bugs.webkit.org/show_bug.cgi?id=237174

        Unreviewed test gardening.

        * platform/ios/TestExpectations:

2022-02-24  Matteo Flores  <matteo_flores@apple.com>

        [ BigSur+ EWS ] imported/w3c/web-platform-tests/speech-api/SpeechSynthesis-speak-twice.html is a flaky ASSERTION FAILED / failure
        https://bugs.webkit.org/show_bug.cgi?id=237172

        Unreviewed test gardening.

        * platform/mac/TestExpectations:

2022-02-24  Matteo Flores  <matteo_flores@apple.com>

        REGRESSION(r290358): [ Debug EWS ] ASSERTION FAILED: sample && sample->pixelBuffer()
        https://bugs.webkit.org/show_bug.cgi?id=237164

        Unreviewed test gardening.

        * platform/ios/TestExpectations:
        * platform/mac/TestExpectations:

2022-02-24  Robert Jenner  <Jenner@apple.com>

        [ BigSur+ EWS ] webgl/pending/conformance/textures/misc/tex-image-video-repeated.html is a flaky timeout
        https://bugs.webkit.org/show_bug.cgi?id=237166

        Unreviewed test gardening.

        * platform/mac/TestExpectations:

2022-02-24  Robert Jenner  <Jenner@apple.com>

        [ BigSur+ Debug wk2 EWS ] imported/w3c/web-platform-tests/html/webappapis/dynamic-markup-insertion/opening-the-input-stream/quirks.window.html is a flaky crash
        https://bugs.webkit.org/show_bug.cgi?id=237165

        Unreviewed test gardening.

        * platform/mac-wk2/TestExpectations:

2022-02-24  Matteo Flores  <matteo_flores@apple.com>

        REGRESSION(r290356-r290351?): [ iOS15 ] 3 imported/w3c/web-platform-tests/service-workers/service-worker/* tests are constant text failures.
        https://bugs.webkit.org/show_bug.cgi?id=237160

        Unreviewed test gardening.

        * platform/ios/TestExpectations:

2022-02-24  Robert Jenner  <Jenner@apple.com>

        REGRESSION(r290351-r290356?): [ iOS EWS ] imported/w3c/web-platform-tests/service-workers/service-worker/partitioned-service-worker-getRegistrations.tentative.https.html is a constant text failure
        https://bugs.webkit.org/show_bug.cgi?id=237162

        Unreviewed test gardening.

        * platform/ios/TestExpectations:

2022-02-24  Robert Jenner  <Jenner@apple.com>

        REGRESSION(r290356-r290351?):[ iOS EWS ] imported/w3c/web-platform-tests/service-workers/service-worker/fetch-request-no-freshness-headers.https.html  is a constant text failure
        https://bugs.webkit.org/show_bug.cgi?id=237161

        Unreviewed test gardening.

        * platform/ios/TestExpectations:

2022-02-24  Robert Jenner  <Jenner@apple.com>

        [ iOS EWS ]imported/w3c/web-platform-tests/css/css-contain/content-visibility/content-visibility-049.htmlis a flaky crash
        https://bugs.webkit.org/show_bug.cgi?id=237159

        Unreviewed test gardening.

        * platform/ios/TestExpectations:

2022-02-24  Robert Jenner  <Jenner@apple.com>

        REGRESSION (r289765-r289784): [iOS] Flaky crash under WebKit::RemoteLayerTreeDrawingAreaProxy::commitLayerTree()
        https://bugs.webkit.org/show_bug.cgi?id=236794

        Unreviewed test gardening.

        * platform/ios/TestExpectations:

2022-02-24  Matteo Flores  <matteo_flores@apple.com>

        [ iOS15 ] fast/events/autoscroll-in-iframe-body.html is a flaky failure.
        https://bugs.webkit.org/show_bug.cgi?id=237150

        Unreviewed Test Gardening.

        * platform/ios/TestExpectations: Flaky Failure expectation while investigating

2022-02-24  Megan Gardner  <megan_gardner@apple.com>

        Add percent decoding to Scroll to Text Fragment parsing.
        https://bugs.webkit.org/show_bug.cgi?id=236818

        Reviewed by Chris Dumez.

        * http/wpt/html/dom/scroll-to-text-fragment/scroll-to-text-fragment-start-emoji-expected.html: Added.
        * http/wpt/html/dom/scroll-to-text-fragment/scroll-to-text-fragment-start-emoji.html: Added.
        * http/wpt/html/dom/scroll-to-text-fragment/scroll-to-text-fragment-start-expected.html: Added.
        * http/wpt/html/dom/scroll-to-text-fragment/scroll-to-text-fragment-start-sentence-expected.html: Added.
        * http/wpt/html/dom/scroll-to-text-fragment/scroll-to-text-fragment-start-sentence.html: Added.
        * http/wpt/html/dom/scroll-to-text-fragment/scroll-to-text-fragment-start.html: Added.

2022-02-24  Alan Bujtas  <zalan@apple.com>

        [IFC][Integration] Enable non-paginated vertical-rl writing mode
        https://bugs.webkit.org/show_bug.cgi?id=236897

        Reviewed by Antti Koivisto.

        * fast/repaint/vertical-text-repaint-expected.txt:
        * platform/ios-simulator-wk2/imported/w3c/web-platform-tests/css/cssom-view/offsetTopLeft-empty-inline-expected.txt:
        * platform/ios-simulator-wk2/imported/w3c/web-platform-tests/css/cssom-view/offsetTopLeft-leading-space-inline-expected.txt:
        * platform/ios/fast/backgrounds/border-radius-split-background-expected.txt:
        * platform/ios/fast/backgrounds/border-radius-split-background-image-expected.txt:
        * platform/ios/fast/borders/border-image-outset-split-inline-vertical-lr-expected.txt:
        * platform/ios/fast/writing-mode/border-styles-vertical-rl-expected.txt:
        * platform/ios/fast/writing-mode/border-styles-vertical-rl-mixed-expected.txt:
        * platform/mac/fast/backgrounds/border-radius-split-background-expected.txt:
        * platform/mac/fast/backgrounds/border-radius-split-background-image-expected.txt:
        * platform/mac/fast/borders/border-image-outset-split-inline-vertical-lr-expected.txt:
        * platform/mac/fast/table/border-collapsing/004-vertical-expected.txt:
        * platform/mac/fast/writing-mode/border-styles-vertical-rl-expected.txt:
        * platform/mac/fast/writing-mode/border-styles-vertical-rl-mixed-expected.txt:

2022-02-24  Kate Cheney  <katherine_cheney@apple.com>

        Update CSP console logging
        https://bugs.webkit.org/show_bug.cgi?id=232216
        <rdar://problem/89322580>

        Reviewed by Brent Fulgham.

        * http/tests/security/contentSecurityPolicy/audio-redirect-blocked-expected.txt:
        * http/tests/security/contentSecurityPolicy/audio-redirect-blocked.html:
        * http/tests/security/contentSecurityPolicy/font-redirect-blocked-expected.txt:
        * http/tests/security/contentSecurityPolicy/font-redirect-blocked.html:
        * http/tests/security/contentSecurityPolicy/image-redirect-blocked-expected.txt:
        * http/tests/security/contentSecurityPolicy/image-redirect-blocked.html:
        * http/tests/security/contentSecurityPolicy/report-blocked-uri-after-multiple-redirects-expected.txt:
        * http/tests/security/contentSecurityPolicy/script-redirect-blocked-expected.txt:
        * http/tests/security/contentSecurityPolicy/script-redirect-blocked.html:
        * http/tests/security/contentSecurityPolicy/stylesheet-redirect-blocked-expected.txt:
        * http/tests/security/contentSecurityPolicy/stylesheet-redirect-blocked.html:
        * http/tests/security/contentSecurityPolicy/svg-font-redirect-blocked-expected.txt:
        * http/tests/security/contentSecurityPolicy/svg-font-redirect-blocked.html:
        * http/tests/security/contentSecurityPolicy/svg-image-redirect-blocked-expected.txt:
        * http/tests/security/contentSecurityPolicy/svg-image-redirect-blocked.html:
        * http/tests/security/contentSecurityPolicy/track-redirect-blocked-expected.txt:
        * http/tests/security/contentSecurityPolicy/track-redirect-blocked.html:
        * http/tests/security/contentSecurityPolicy/video-redirect-blocked-expected.txt:
        * http/tests/security/contentSecurityPolicy/video-redirect-blocked.html:
        * http/tests/security/contentSecurityPolicy/xsl-redirect-blocked-expected.txt:

2022-02-24  Alan Bujtas  <zalan@apple.com>

        [LFC][IFC] Non-orthogonal inline block boxes keep their baseline on ideographic lines
        https://bugs.webkit.org/show_bug.cgi?id=236946

        Reviewed by Antti Koivisto.

        * platform/mac/fast/writing-mode/border-styles-vertical-lr-mixed-expected.txt: Progression

2022-02-24  Devin Rousso  <drousso@apple.com>

        Web Inspector: merge WI.OverlayManager into WI.DOMNode
        https://bugs.webkit.org/show_bug.cgi?id=236533

        Reviewed by Patrick Angle.

        * inspector/dom/showFlexOverlay.html:
        * inspector/dom/showGridOverlay.html:
        Replace direct `DOMAgent` calls with equivalent `WI.DOMNode` methods.

2022-02-24  Frédéric Wang  <fwang@igalia.com>

        RELEASE_ASSERT(!renderer()); in WebCore::Node::~Node() + 479 (Node.cpp:366)
        https://bugs.webkit.org/show_bug.cgi?id=235380

        Reviewed by Ryosuke Niwa.

        Add non-regression test.

        * fast/shadow-dom/slot-with-pseudo-element-children-renderer-teardown-expected.txt: Added.
        * fast/shadow-dom/slot-with-pseudo-element-children-renderer-teardown.html: Added.

2022-02-24  Youenn Fablet  <youenn@apple.com>

        webrtc/video-replace-muted-track.html is unnecessary long to run
        https://bugs.webkit.org/show_bug.cgi?id=237086

        Reviewed by Peng Liu.

        * platform/mac/TestExpectations: Unflake test since it is no longer flaky in bots.
        * webrtc/routines.js:
        We were waiting for 360 iterations to validate no black frame is found in webrtc/routines.js.
        This makes it last around 20 seconds.
        Decrease the number of iterations to 40, around 2 seconds by decrementing counter from provided value
        instead of incrementing value up to 400.

2022-02-24  Alejandro G. Castro  <alex@igalia.com>

        Unreviewed test gardening.

        Another WebGL test with failing expected results in glib.

        * platform/glib/TestExpectations:
        * platform/glib/webgl/webgl-allow-shared-expected.txt: Removed.

2022-02-23  Commit Queue  <commit-queue@webkit.org>

        Unreviewed, reverting r290284.
        https://bugs.webkit.org/show_bug.cgi?id=237131

        It is preventing the fuzzer from finding other bugs

        Reverted changeset:

        "Make input element UA shadow tree creation lazy"
        https://bugs.webkit.org/show_bug.cgi?id=236747
        https://commits.webkit.org/r290284

2022-02-23  Tim Nguyen  <ntim@apple.com>

        Use of showModalDialog should appear as a warning in WI console
        https://bugs.webkit.org/show_bug.cgi?id=237046

        Reviewed by Devin Rousso.

        Test gardening to take in account new console warning.

        * fast/animation/request-animation-frame-during-modal-expected.txt:
        * fast/dom/Window/open-window-min-size-expected.txt:
        * fast/events/show-modal-dialog-onblur-onfocus-expected.txt:
        * http/tests/cookies/document-cookie-after-showModalDialog-expected.txt:
        * http/tests/security/navigate-when-restoring-cached-page-expected.txt:
        * http/tests/security/showModalDialog-sync-cross-origin-page-load2-expected.txt:
        * platform/mac-wk1/fast/events/beforeunload-showModalDialog-expected.txt: Added.
        * platform/mac-wk1/fast/events/pagehide-showModalDialog-expected.txt: Added.
        * platform/mac-wk1/fast/events/unload-showModalDialog-expected.txt: Added.
        * platform/wincairo-wk1/fast/events/beforeunload-showModalDialog-expected.txt: Added.
        * platform/wincairo-wk1/fast/events/pagehide-showModalDialog-expected.txt: Added.
        * platform/wincairo-wk1/fast/events/unload-showModalDialog-expected.txt: Added.

2022-02-23  Robert Jenner  <Jenner@apple.com>

        [ Mac wk1 Release ] imported/w3c/web-platform-tests/html/user-activation/activation-trigger-pointerevent.html is a constant text failure
        https://bugs.webkit.org/show_bug.cgi?id=236126

        Unreviewed test gardening.

        * platform/mac-wk1/TestExpectations:

2022-02-23  Robert Jenner  <Jenner@apple.com>

        Unreviewed, reverting r290351 and r290404.

        Broke the build after revert of initial commit (r290348)
        Rebases no longer needed due to revert

        Reverted changesets:

        "Use of showModalDialog should appear as a warning in WI
        console"
        https://bugs.webkit.org/show_bug.cgi?id=237046
        https://commits.webkit.org/r290351

        "Use of showModalDialog should appear as a warning in WI
        console"
        https://bugs.webkit.org/show_bug.cgi?id=237046
        https://commits.webkit.org/r290404

2022-02-23  Robert Jenner  <Jenner@apple.com>

        Use of showModalDialog should appear as a warning in WI console
        https://bugs.webkit.org/show_bug.cgi?id=237046

        Unreviewed test gardening. Rebase for wk1 mac and Windows tests.

        * platform/mac-wk1/fast/events/beforeunload-showModalDialog-expected.txt: Added.
        * platform/mac-wk1/fast/events/pagehide-showModalDialog-expected.txt: Added.
        * platform/mac-wk1/fast/events/unload-showModalDialog-expected.txt: Added.
        * platform/wincairo-wk1/fast/events/beforeunload-showModalDialog-expected.txt: Added.
        * platform/wincairo-wk1/fast/events/pagehide-showModalDialog-expected.txt: Added.
        * platform/wincairo-wk1/fast/events/unload-showModalDialog-expected.txt: Added.

2022-02-23  J Pascoe  <j_pascoe@apple.com>

        [WebAuthn] Improve error message for missing pubKeyCredParams
        https://bugs.webkit.org/show_bug.cgi?id=235421
        rdar://87884875

        Reviewed by Brent Fulgham.

        Update test to reflect new error message.

        * http/wpt/webauthn/public-key-credential-create-failure.https.html:

2022-02-23  Alan Bujtas  <zalan@apple.com>

        [Subpixel] imported/w3c/web-platform-tests/css/css-flexbox/auto-margins-001.html fails at certain font sizes
        https://bugs.webkit.org/show_bug.cgi?id=217643
        <rdar://problem/70464703>

        Unreviewed gardening.

        * platform/ios-simulator-wk2/TestExpectations: It must have progressed at some point.

2022-02-23  Robert Jenner  <Jenner@apple.com>

        [ Mac EWS ] imported/w3c/web-platform-tests/workers/semantics/multiple-workers/004.html is a flaky text failure
        https://bugs.webkit.org/show_bug.cgi?id=237095

        Unreviewed test gardening.

        * platform/mac-wk2/TestExpectations: Setting [ Pass Failure ] expectations for flaky test failure that is slowing down EWS.

2022-02-23  Jon Lee  <jonlee@apple.com>

        Unreviewed gardening for GPU Process bot.

        * imported/blink/svg/paintorder/paintorder.svg:

2022-02-23  Jon Lee  <jonlee@apple.com>

        Test gardening for [CSS Blending] Non-separable blend modes don't work
        https://bugs.webkit.org/show_bug.cgi?id=131354

        Unreviewed.
        * TestExpectations:

2022-02-23  Andres Gonzalez  <andresg_22@apple.com>

        Fix for assert crash in AccessibilityRenderObject::visiblePositionForIndex.
        https://bugs.webkit.org/show_bug.cgi?id=236795
        rdar://89025180

        Reviewed by Chris Fleizach.

        * accessibility/native-text-control-attributed-string-expected.txt: Added.
        * accessibility/native-text-control-attributed-string.html: Added.

2022-02-23  Alejandro G. Castro  <alex@igalia.com>

        Unreviewed test gardening.

        These tests had incorrect expected results with failing tests for
        glib.

        * platform/glib/TestExpectations:
        * platform/glib/webgl/1.0.3/conformance/context/context-lost-restored-expected.txt: Removed.
        * platform/glib/webgl/1.0.3/conformance/extensions/oes-texture-half-float-expected.txt: Removed.
        * platform/glib/webgl/1.0.3/conformance/extensions/webgl-compressed-texture-s3tc-expected.txt: Removed.
        * platform/glib/webgl/1.0.3/conformance/extensions/webgl-compressed-texture-size-limit-expected.txt: Removed.
        * platform/glib/webgl/1.0.3/conformance/misc/webgl-specific-expected.txt: Removed.
        * platform/glib/webgl/1.0.3/conformance/renderbuffers/framebuffer-object-attachment-expected.txt: Removed.
        * platform/glib/webgl/1.0.3/conformance/rendering/point-no-attributes-expected.txt: Removed.
        * platform/glib/webgl/1.0.3/conformance/textures/texture-copying-feedback-loops-expected.txt: Removed.

2022-02-23  Kimmo Kinnunen  <kkinnunen@apple.com>

        Crash when calling WEBGL_lose_context.loseContext() after the context has been lost
        https://bugs.webkit.org/show_bug.cgi?id=236966

        Reviewed by Dean Jackson.

        * webgl/lose-context-after-context-lost-expected.txt: Added.
        * webgl/lose-context-after-context-lost.html: Added.

2022-02-23  Youenn Fablet  <youenn@apple.com>

        Enable WebRTCRemoteVideoFrameEnabled by default in WebKitTestRunner
        https://bugs.webkit.org/show_bug.cgi?id=236969

        Reviewed by Eric Carlson.

        Disable WebRTCRemoteVideoFrameEnabled for those two tests until we figure out why they fail more with this option.

        * fast/mediastream/getUserMedia-to-canvas-1.html:
        * fast/mediastream/getUserMedia-to-canvas-2.html:

2022-02-22  Chris Dumez  <cdumez@apple.com>

        http/wpt/push-api/onpush-disabled.html fails
        https://bugs.webkit.org/show_bug.cgi?id=236874
        <rdar://problem/89176154>

        Reviewed by Youenn Fablet.

        Unskip test that should no longer be flaky.

        * TestExpectations:

2022-02-22  Tim Nguyen  <ntim@apple.com>

        Use of showModalDialog should appear as a warning in WI console
        https://bugs.webkit.org/show_bug.cgi?id=237046

        Reviewed by Devin Rousso and Darin Adler.

        Test gardening to take in account new console warning.

        * fast/animation/request-animation-frame-during-modal-expected.txt:
        * fast/dom/Window/open-window-min-size-expected.txt:
        * fast/events/show-modal-dialog-onblur-onfocus-expected.txt:
        * http/tests/cookies/document-cookie-after-showModalDialog-expected.txt:
        * http/tests/security/navigate-when-restoring-cached-page-expected.txt:
        * http/tests/security/showModalDialog-sync-cross-origin-page-load2-expected.txt:

2022-02-22  Ryan Haddad  <ryanhaddad@apple.com>

        Unreviewed test gardening for rdar://86037417.

        * platform/mac-wk2/TestExpectations:

2022-02-22  Frédéric Wang  <fwang@igalia.com>

        null ptr deref via WebXRSystem::requestSession
        https://bugs.webkit.org/show_bug.cgi?id=235916

        Reviewed by Dean Jackson.

        Add non-regression test.

        * webxr/xr-requestSession-crash-expected.txt: Added.
        * webxr/xr-requestSession-crash.html: Added.

2022-02-22  Philippe Normand  <pnormand@igalia.com>

        [GStreamer] Initial MediaRecorder implementation
        https://bugs.webkit.org/show_bug.cgi?id=236558

        Reviewed by Xabier Rodriguez-Calvar.

        Flag the remaining MediaRecorder test failures. Those will be adressed in follow-up patches.

        * http/wpt/mediarecorder/pause-recording.html:
        * platform/glib/TestExpectations:

2022-02-22  Kate Cheney  <katherine_cheney@apple.com>

        Authenticated encryption console logging causing performance regressions
        https://bugs.webkit.org/show_bug.cgi?id=236987
        <rdar://problem/89108253>

        Reviewed by Chris Dumez.

        * crypto/subtle/aes-cbc-cfb-decrypt-malformed-parameters-expected.txt:
        * crypto/subtle/aes-cbc-cfb-encrypt-malformed-parameters-expected.txt:
        * crypto/subtle/aes-cbc-generate-key-encrypt-decrypt-expected.txt:
        * crypto/subtle/aes-cbc-import-key-decrypt-expected.txt:
        * crypto/subtle/aes-cbc-import-key-encrypt-expected.txt:
        * crypto/subtle/aes-ctr-encrypt-malformed-parameters-expected.txt:
        * crypto/subtle/aes-ctr-generate-key-encrypt-decrypt-expected.txt:
        * crypto/subtle/aes-ctr-import-key-encrypt-expected.txt:
        * platform/glib/crypto/subtle/aes-cbc-cfb-decrypt-malformed-parameters-expected.txt:
        * platform/glib/crypto/subtle/aes-cbc-cfb-encrypt-malformed-parameters-expected.txt:

2022-02-22  Youenn Fablet  <youenn@apple.com>

        http/wpt/mediarecorder/mute-tracks.html fails with WebRTCRemoteVideoFrameEnabled=true
        https://bugs.webkit.org/show_bug.cgi?id=237021

        Reviewed by Kimmo Kinnunen.

        * http/wpt/mediarecorder/mute-tracks.html:

2022-02-22  Tim Nguyen  <ntim@apple.com>

        Make pointer-events checks for SVG take in account inert subtrees
        https://bugs.webkit.org/show_bug.cgi?id=235836

        Reviewed by Antti Koivisto.

        iOS doesn't support test_actions, so it needs different baselines.

        * platform/ios-wk2/imported/w3c/web-platform-tests/html/semantics/interactive-elements/the-dialog-element/inert-svg-hittest-expected.txt: Added.
        * platform/ios-wk2/imported/w3c/web-platform-tests/inert/inert-svg-hittest.tentative-expected.txt: Added.

2022-02-22  Jonathan Bedard  <jbedard@apple.com>

        Unreviewed, reverting r290220.

        Tests still fail with with fuzzy data

        Reverted changeset:

        "Test gardening for [CSS Blending] Non-separable blend modes
        don't work"
        https://bugs.webkit.org/show_bug.cgi?id=131354
        https://commits.webkit.org/r290220

2022-02-22  Asumu Takikawa  <asumu@igalia.com>

        Initial support for Wasm/ESM-integration in the WebCore module loader
        https://bugs.webkit.org/show_bug.cgi?id=236268

        Reviewed by Yusuke Suzuki.

        Add Wasm module MIME type for HTTP tests, and add tests.

        * http/conf/mime.types:
        * http/tests/wasm/resources/empty-module.wasm: Added.
        * http/tests/wasm/wasm-esm-disabled-with-setting-expected.txt: Added.
        * http/tests/wasm/wasm-esm-disabled-with-setting.html: Added.

2022-02-21  Cameron McCormack  <heycam@apple.com>

        Make input element UA shadow tree creation lazy
        https://bugs.webkit.org/show_bug.cgi?id=236747

        Reviewed by Aditya Keerthi.

        * fast/forms/lazy-shadow-tree-creation-expected.html: Added.
        * fast/forms/lazy-shadow-tree-creation.html: Added.
        * fast/forms/lazy-shadow-tree-creation.js: Added.
        (supportsType):
        (makeAndAppendInput):

2022-02-21  Jon Lee  <jonlee@apple.com>

        Unreviewed gardening for the GPU Process bots.
        * css3/color-filters/color-filter-text-decoration-shadow.html:
        * fast/gradients/conic-gradient-alpha-unpremultiplied.html:
        * fast/gradients/conic-gradient-alpha.html:
        * fast/gradients/linear-two-hints-angle.html:
        * fast/scrolling/overflow-inside-foreignobject.html:
        * gpu-process/TestExpectations:
        * imported/blink/svg/custom/crisp-edges-leak.svg:
        * platform/ios/TestExpectations:

2022-02-21  Jon Lee  <jonlee@apple.com>

        Add test name to the image diff template
        https://bugs.webkit.org/show_bug.cgi?id=237003

        Reviewed by Sam Weinig.

        Include the test name in the page. Workflow to update fuzzy match data becomes easier to copy-paste the name there instead of from the location bar.
        * fast/harness/image-diff-template-expected.txt:
        * fast/harness/image-diff-template.html:

== Rolled over to ChangeLog-2022-02-22 ==
